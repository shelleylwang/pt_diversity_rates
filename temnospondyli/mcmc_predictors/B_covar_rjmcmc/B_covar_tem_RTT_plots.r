

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/temnospondyli/mcmc_predictors/B_covar/B_covar_tem_RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2), 
    oma=c(0,0,3,0),     # Increased top outer margin from 2 to 3
    mar=c(5,5,4,2)+0.1, # Increase plot margins for larger axis labels
    cex.lab=1.5,        # Increase axis label size
    cex.axis=1.2)       # Increase axis tick label size
library(scales)

time=c(-27.809419225, -28.882901675,-29.956384125,-31.029866575,-32.103349025,-33.176831475,-34.250313925,-35.323796375,-36.397278825,-37.470761275,-38.544243725,-39.617726175,-40.691208625,-41.764691075,-42.838173525,-43.911655975,-44.985138425,-46.058620875,-47.132103325,-48.205585775,-49.279068225,-50.352550675,-51.426033125000004,-52.499515575,-53.572998025,-54.646480475,-55.719962925,-56.793445375,-57.866927825,-58.940410275,-60.013892725,-61.087375175,-62.160857625,-63.234340075,-64.30782252499999,-65.38130497499999,-66.45478742499999,-67.52826987499999,-68.60175232499999,-69.67523477499999,-70.748717225,-71.822199675,-72.895682125,-73.969164575,-75.042647025,-76.116129475,-77.189611925,-78.263094375,-79.336576825,-80.410059275,-81.483541725,-82.557024175,-83.630506625,-84.703989075,-85.777471525,-86.850953975,-87.924436425,-88.997918875,-90.071401325,-91.144883775,-92.218366225,-93.291848675,-94.365331125,-95.438813575,-96.512296025,-97.585778475,-98.659260925,-99.732743375,-100.806225825,-101.879708275,-102.953190725,-104.026673175,-105.100155625,-106.173638075,-107.247120525,-108.320602975,-109.394085425,-110.467567875,-111.541050325,-112.614532775,-113.688015225,-114.761497675,-115.834980125,-116.908462575,-117.981945025,-119.055427475,-120.128909925,-121.202392375,-122.275874825,-123.349357275,-124.422839725,-125.496322175,-126.569804625,-127.643287075,-128.71676952500002,-129.790251975,-130.86373442499996,-131.937216875,-133.01069932499996,-134.084181775)
rate=c(0.027461162516772636, 0.027406120332385923,0.027406120332385923,0.027406120332385923,0.027406120332385923,0.027406120332385923,0.027406120332385923,0.02735539806817207,0.02735539806817207,0.027406120332385923,0.027406120332385923,0.027406120332385923,0.027475991598141312,0.02748112238679984,0.027482745948078504,0.027510503075280784,0.027627933007497496,0.0277008249452075,0.027706584834456493,0.02772540072129573,0.027787459539380707,0.028319948495722867,0.028977714607162697,0.030317591806338244,0.03170121023283169,0.03396861199476052,0.036318570434970276,0.03900348788127094,0.04226513996721737,0.046598792584591334,0.06633141025738601,0.12156748737085611,0.17093809684218228,0.18417181573627203,0.18984837797848692,0.19240412520048705,0.18776778623292417,0.1913881670310263,0.20267123175451787,0.2523309480668175,0.2964954559552743,0.33009545258478307,0.3401952030346298,0.33677765322686476,0.33677765322686476,0.33702764779592437,1.7957444919435326,0.11633783618416069,0.0918279763844966,0.09100666040516613,0.09053943301310224,0.0903184506906961,0.0903184506906961,0.0903184506906961,0.09053943301310224,0.09053943301310224,0.0906058441495755,0.09076146823182982,0.09076146823182982,0.09076146823182982,0.09092911125407371,0.08912111530201919,0.08750480356513315,0.08436716096661315,0.08283907775895663,0.08118980254312777,0.08003036142310761,0.07795759651038608,0.07497703169061984,0.0719098258752934,0.0683284611952543,0.06669974827259298,0.06625560898771682,0.06618315010180949,0.06608828169195788,0.06600572311005912,0.06600572311005912,0.06592413273509215,0.06592413273509215,0.06592413273509215,0.06607971922756539,0.06610781752889373,0.06610781752889373,0.0661421097011537,0.06669974827259298,0.068139967204386,0.07046103315841895,0.0769800436481009,0.08311336496870628,0.10358150695829313,0.2624146892124126,0.281003019038935,0.29691423179513116,0.30084223304046015,0.30357161741837857,0.30442562316943433,0.30500370687328865,0.30531685519081486,0.3084597349309057,0.42837877717383155)
minHPD=c(0.005481835722205206, 0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005004130239218533,0.005481835722205206,0.005481835722205206,0.005481835722205206,0.005219478154467286,0.005219478154467286,0.005219478154467286,0.0054942764994556905,0.003965899653618383,0.003965899653618383,0.0054942764994556905,0.006057626483201234,0.011754747216082008,0.010790117639081326,0.009479695161707402,0.009479695161707402,0.012054384365546778,0.016130639444300047,0.029958107758882406,0.040520627926368666,0.04377018568207533,0.04377018568207533,0.04377018568207533,0.04377018568207533,0.045585266243145406,0.03702065265149919,0.08992880900475955,0.16516942318855699,0.21551846637560462,0.20368823079342757,0.20614341493073732,0.19503446751539064,0.9969986403281129,0.049968160839045886,0.056667016052741145,0.056667016052741145,0.056667016052741145,0.056667016052741145,0.056667016052741145,0.056667016052741145,0.05704463795626051,0.056667016052741145,0.05776320143343325,0.05776320143343325,0.056667016052741145,0.056667016052741145,0.056667016052741145,0.05340577360265101,0.04983028297045121,0.043091499358799905,0.043091499358799905,0.039601290495354845,0.03132443405010471,0.03638156074377741,0.03114707142561311,0.025841625424660924,0.025719926406173307,0.025719926406173307,0.026113074854900387,0.026512390808354814,0.026512390808354814,0.026590227821988284,0.026590227821988284,0.026590227821988284,0.026590227821988284,0.027338087295893463,0.027338087295893463,0.027338087295893463,0.027338087295893463,0.027338087295893463,0.026113074854900387,0.019393033207345842,0.02276874837000412,0.03158892739692227,0.03900097492305571,0.04090623872409178,0.04879864636155867,0.0578969105037163,0.17185369923607863,0.17185369923607863,0.17185369923607863,0.17431431682487544,0.16442067000138852,0.1782756505860945,0.14725911034562159,0.17431431682487544)
maxHPD=c(0.05914637809247482, 0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.05909967238226731,0.059408322965088314,0.059408322965088314,0.05914637809247482,0.05969486975968603,0.05988812303259195,0.059988161625477376,0.059988161625477376,0.059988161625477376,0.061555465874025245,0.06954738333316159,0.08497179478444238,0.10928886172905221,0.12210691390911191,0.1365963406395486,0.14780744773659846,0.15436321566033717,0.1675797689947382,0.19290879433797478,0.25795199369894506,0.30722563164562333,0.3288481717974075,0.3288481717974075,0.3288481717974075,0.330357495664038,0.33146135566313,0.33260245237647407,0.341159369077643,0.3706002531885973,0.486125388078811,0.5961374968031226,0.595524317679861,0.5603482616536333,0.5603482616536333,0.5603482616536333,2.78164328661007,1.896435444217441,0.18743079582581995,0.18169629638876145,0.17995625100293328,0.17995625100293328,0.17995625100293328,0.17995625100293328,0.1807947221905866,0.17995625100293328,0.1807947221905866,0.1807947221905866,0.17995625100293328,0.17995625100293328,0.18110447267762322,0.1819575008713315,0.1819575008713315,0.1739325859244344,0.1747675440618814,0.17172443581701957,0.15995722718238803,0.1582521208959256,0.14488204459356402,0.1325463210777423,0.10517338279773666,0.09469417289444569,0.09390473242950718,0.09390473242950718,0.09364923205106053,0.09364923205106053,0.09364923205106053,0.09364923205106053,0.09364923205106053,0.09390473242950718,0.09358343163419122,0.09358343163419122,0.09358343163419122,0.09364923205106053,0.09390473242950718,0.09861533136613009,0.19055819960039472,0.2740820023790373,0.2996935193965327,0.3314469415401527,0.4203250967379285,0.45935316043169855,0.5430704654346798,0.5172617871312792,0.5172617871312792,0.5210351339985477,0.5210351339985477,0.5426692674476373,0.5802280075806165,1.6832515453522132)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.0598076152710774), xlim = c(-134.620923,-27.272678), ylab = 'Speciation rate', xlab = 'Time',main='Speciation' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mtext("Temnospondyli CoVar RJMCMC RTT Plots (Combined 10 Replicates)", outer = TRUE, line = 0.5, cex = 1.5, font = 2)
mids=c(-27.81484085353535, -28.899166560606062,-29.983492267676766,-31.067817974747477,-32.15214368181818,-33.23646938888889,-34.320795095959596,-35.40512080303031,-36.48944651010101,-37.573772217171715,-38.658097924242426,-39.74242363131313,-40.82674933838384,-41.911075045454545,-42.99540075252525,-44.07972645959596,-45.16405216666667,-46.248377873737375,-47.33270358080808,-48.41702928787879,-49.501354994949494,-50.585680702020206,-51.67000640909091,-52.75433211616161,-53.838657823232325,-54.922983530303036,-56.00730923737374,-57.09163494444444,-58.17596065151515,-59.26028635858586,-60.34461206565657,-61.428937772727274,-62.51326347979798,-63.59758918686868,-64.68191489393939,-65.7662406010101,-66.8505663080808,-67.93489201515152,-69.01921772222221,-70.10354342929293,-71.18786913636363,-72.27219484343433,-73.35652055050505,-74.44084625757574,-75.52517196464646,-76.60949767171716,-77.69382337878787,-78.77814908585859,-79.86247479292928,-80.9468005,-82.0311262070707,-83.1154519141414,-84.19977762121212,-85.28410332828282,-86.36842903535353,-87.45275474242423,-88.53708044949494,-89.62140615656566,-90.70573186363636,-91.79005757070706,-92.87438327777777,-93.95870898484849,-95.04303469191919,-96.1273603989899,-97.2116861060606,-98.2960118131313,-99.38033752020202,-100.46466322727272,-101.54898893434343,-102.63331464141413,-103.71764034848485,-104.80196605555555,-105.88629176262626,-106.97061746969696,-108.05494317676767,-109.13926888383838,-110.22359459090909,-111.30792029797979,-112.3922460050505,-113.47657171212121,-114.56089741919192,-115.64522312626262,-116.72954883333333,-117.81387454040403,-118.89820024747475,-119.98252595454545,-121.06685166161616,-122.15117736868686,-123.23550307575756,-124.31982878282828,-125.40415448989899,-126.48848019696969,-127.5728059040404,-128.6571316111111,-129.74145731818183,-130.82578302525252,-131.9101087323232,-132.99443443939393,-134.07876014646465)
counts=c(0.0011111111111111111, 0.0,0.0,0.0011111111111111111,0.0,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0,0.0044444444444444444,0.0,0.0022222222222222222,0.0044444444444444444,0.0011111111111111111,0.0022222222222222222,0.0022222222222222222,0.0011111111111111111,0.012222222222222223,0.022222222222222223,0.034444444444444444,0.043333333333333335,0.044444444444444446,0.04888888888888889,0.057777777777777775,0.04888888888888889,0.03888888888888889,0.06666666666666667,0.10888888888888888,0.20666666666666667,0.17,0.01,0.006666666666666667,0.006666666666666667,0.005555555555555556,0.006666666666666667,0.028888888888888888,0.20444444444444446,0.18444444444444444,0.13666666666666666,0.03333333333333333,0.0044444444444444444,0.0011111111111111111,0.2,0.8188888888888889,0.9311111111111111,0.04111111111111111,0.006666666666666667,0.0022222222222222222,0.0011111111111111111,0.0,0.0011111111111111111,0.0033333333333333335,0.0,0.0022222222222222222,0.0,0.0011111111111111111,0.005555555555555556,0.01,0.03111111111111111,0.034444444444444444,0.028888888888888888,0.028888888888888888,0.03,0.03,0.06111111111111111,0.08333333333333333,0.07,0.051111111111111114,0.006666666666666667,0.005555555555555556,0.0033333333333333335,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0022222222222222222,0.0033333333333333335,0.0022222222222222222,0.0,0.0,0.01,0.02666666666666667,0.044444444444444446,0.14333333333333334,0.12333333333333334,0.13,0.2677777777777778,0.15666666666666668,0.09,0.022222222222222223,0.014444444444444444,0.005555555555555556,0.0077777777777777776,0.0033333333333333335,0.027777777777777776,0.33555555555555555,0.5311111111111111)
plot(mids,counts,type = 'h', xlim = c(-134.620923,-27.272678), ylim=c(0,0.9311111111111111), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03413331064784713
bf6 = 0.2070578471610477
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-27.809419225, -28.882901675,-29.956384125,-31.029866575,-32.103349025,-33.176831475,-34.250313925,-35.323796375,-36.397278825,-37.470761275,-38.544243725,-39.617726175,-40.691208625,-41.764691075,-42.838173525,-43.911655975,-44.985138425,-46.058620875,-47.132103325,-48.205585775,-49.279068225,-50.352550675,-51.426033125000004,-52.499515575,-53.572998025,-54.646480475,-55.719962925,-56.793445375,-57.866927825,-58.940410275,-60.013892725,-61.087375175,-62.160857625,-63.234340075,-64.30782252499999,-65.38130497499999,-66.45478742499999,-67.52826987499999,-68.60175232499999,-69.67523477499999,-70.748717225,-71.822199675,-72.895682125,-73.969164575,-75.042647025,-76.116129475,-77.189611925,-78.263094375,-79.336576825,-80.410059275,-81.483541725,-82.557024175,-83.630506625,-84.703989075,-85.777471525,-86.850953975,-87.924436425,-88.997918875,-90.071401325,-91.144883775,-92.218366225,-93.291848675,-94.365331125,-95.438813575,-96.512296025,-97.585778475,-98.659260925,-99.732743375,-100.806225825,-101.879708275,-102.953190725,-104.026673175,-105.100155625,-106.173638075,-107.247120525,-108.320602975,-109.394085425,-110.467567875,-111.541050325,-112.614532775,-113.688015225,-114.761497675,-115.834980125,-116.908462575,-117.981945025,-119.055427475,-120.128909925,-121.202392375,-122.275874825,-123.349357275,-124.422839725,-125.496322175,-126.569804625,-127.643287075,-128.71676952500002,-129.790251975,-130.86373442499996,-131.937216875,-133.01069932499996,-134.084181775)
rate=c(0.6828628703256286, 0.06447282321961327,0.05610997852996878,0.05279020603017348,0.05117941087472518,0.05076029974231572,0.050505657463230325,0.05048664878861285,0.050363351300622236,0.04999440166581408,0.04978815062502416,0.04955774279662951,0.04953676780409309,0.04953676780409309,0.04953676780409309,0.04953676780409309,0.049494968196926475,0.049494968196926475,0.04953676780409309,0.04955774279662951,0.04961831631164255,0.04991079528796054,0.05024204673283343,0.05067457963766875,0.051294017224115265,0.05153597554099387,0.05201834853951798,0.05309728043225494,0.05332334750615706,0.05359207145106525,0.05385748360639897,0.05686925365560502,0.06529454462516335,0.07490407119812463,0.07867006248404576,0.09526901581918679,0.22878817757443815,0.3763859412777558,0.38153888821985105,0.3834352567658498,0.38608382024817633,0.40435136889541334,0.4414292213617126,0.4289409267194112,0.42781179075935966,0.4281339225157811,0.45321200749593354,0.4007545418912558,0.2985897434806041,0.18892008582949568,0.16428858353233766,0.14600285835303423,0.12778336830861178,0.123270744312828,0.12055890075321163,0.12031735577654018,0.12017911556547514,0.12023571559658697,0.11874432405928428,0.11617067304996304,0.11253391964169862,0.1106755152659267,0.10851908063557691,0.1071704527813955,0.10648600831191093,0.10558044315417914,0.103288321912775,0.10053251102260685,0.09689938313232742,0.09352654684550071,0.091000127876558,0.08943613050227342,0.08885965644084774,0.08820954713514856,0.08812716783045978,0.08771154582914431,0.08757325354697987,0.08734735375565558,0.08732969743866184,0.0873099047518553,0.08728312092139115,0.08728312092139115,0.08728312092139115,0.08728312092139115,0.08728312092139115,0.08728312092139115,0.08732140675825714,0.08732140675825714,0.08732969743866184,0.08752509511220236,0.08796830580643436,0.09017225969406971,0.09494414377694332,0.09515108410125614,0.09583562270685209,0.0963443174467743,0.10035797355704845,0.11253391964169862,0.4981724324943585,0.5219004793444189)
minHPD=c(0.021412629665227476, 0.0036344703167680375,0.002777909115374498,0.0004014064218278715,0.0004014064218278715,0.0021868745333137275,0.0021868745333137275,0.0004014064218278715,0.002777909115374498,0.0036344703167680375,0.0053170022390624985,0.002777909115374498,0.0029017146430717895,0.0036344703167680375,0.0036344703167680375,0.0036344703167680375,0.0036344703167680375,0.0036344703167680375,0.0036344703167680375,0.0036344703167680375,0.0029017146430717895,0.009250790260096387,0.01064583104572398,0.009250790260096387,0.01064583104572398,0.016809951846000388,0.01914609162571786,0.02053233210032963,0.02053233210032963,0.02053233210032963,0.01961643187698391,0.02053233210032963,0.02358956325122062,0.029946797788706923,0.02995771155273301,0.02995771155273301,0.03818455258375003,0.13416112933234162,0.1460409508399913,0.1460409508399913,0.1460409508399913,0.17892533667064683,0.2644351272807987,0.26717459466846116,0.26717459466846116,0.26717459466846116,0.24052523730127492,0.08532237691756399,0.08112092299098445,0.0730911313220588,0.07668628278428313,0.07651753416245516,0.06873932772493463,0.06696454279609032,0.07048243005843577,0.07195153955821346,0.07048243005843577,0.07048243005843577,0.07195153955821346,0.07048243005843577,0.07195153955821346,0.06446519527349544,0.06520016677654994,0.06520016677654994,0.06520016677654994,0.06520016677654994,0.06126478698404853,0.05830438002040873,0.05427022517875427,0.05070648533916386,0.05070648533916386,0.0492637170256455,0.048463425007307485,0.048463425007307485,0.05116655037326282,0.051843632398157424,0.05265330705089381,0.05245827560187638,0.05045767483961658,0.05070648533916386,0.05070648533916386,0.05070648533916386,0.05070648533916386,0.05070648533916386,0.05070648533916386,0.05070648533916386,0.05116655037326282,0.05116655037326282,0.05070648533916386,0.05045767483961658,0.051935940956451244,0.04467011785218897,0.04940512916033939,0.05427022517875427,0.05116655037326282,0.054597422425382666,0.04940512916033939,0.05427022517875427,0.06987821609390617,0.1755507496056894)
maxHPD=c(2.7281693789661303, 1.2316308252031456,0.8164092825516184,0.46040787673304573,0.2500565206327414,0.1771559787414897,0.09606589571410497,0.0911328212993432,0.08780838607217886,0.08415327130935289,0.08415327130935289,0.07675135265581241,0.07675135265581241,0.07675135265581241,0.07675135265581241,0.07675135265581241,0.07666072708720328,0.07666072708720328,0.07666072708720328,0.07666072708720328,0.07675135265581241,0.08415327130935289,0.08755609785351036,0.08783621544292358,0.09452323125790572,0.1026300159042882,0.11618510757048575,0.13195039414467444,0.1386299869985119,0.14427481688016985,0.15180280165029955,0.23486201129591097,0.3339676269491004,0.37847804141795754,0.3800784822984097,0.4008279917729922,0.46776254003540785,0.5304459186891799,0.5131791337940593,0.5131791337940593,0.5167970668099232,0.5930335676864245,1.204518195949065,0.6567788589611118,0.6550946145819997,0.6567788589611118,1.3109639622563436,0.6756548167992431,0.52481876298495,0.4785200653630995,0.43188144358284924,0.4047681136986169,0.2742745042110754,0.2549879674022221,0.2475380853954943,0.2475380853954943,0.24362476110352518,0.24362476110352518,0.24210563205848387,0.2340742740355699,0.2313842696261283,0.22222806408270915,0.22154213264070785,0.22180746302487203,0.22154213264070785,0.22154213264070785,0.21526748902316087,0.20116591892884833,0.19618541799229158,0.17876020233722995,0.15967173201623594,0.13589533842470297,0.12464460402053483,0.12063780312289886,0.12063780312289886,0.12063780312289886,0.12063780312289886,0.12063780312289886,0.11795447164418833,0.1178258660653852,0.1178258660653852,0.1178258660653852,0.1178258660653852,0.1178258660653852,0.1178258660653852,0.1178258660653852,0.11795447164418833,0.11795447164418833,0.1178258660653852,0.11795447164418833,0.12063780312289886,0.18135448843792204,0.3052948630163692,0.3137985822749434,0.3176114284582088,0.3429310003090953,0.4511715563754872,0.6161416320693358,0.9132098226983931,0.9848201305062075)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.0009863168627438), xlim = c(-134.620923,-27.272678), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-27.81484085353535, -28.899166560606062,-29.983492267676766,-31.067817974747477,-32.15214368181818,-33.23646938888889,-34.320795095959596,-35.40512080303031,-36.48944651010101,-37.573772217171715,-38.658097924242426,-39.74242363131313,-40.82674933838384,-41.911075045454545,-42.99540075252525,-44.07972645959596,-45.16405216666667,-46.248377873737375,-47.33270358080808,-48.41702928787879,-49.501354994949494,-50.585680702020206,-51.67000640909091,-52.75433211616161,-53.838657823232325,-54.922983530303036,-56.00730923737374,-57.09163494444444,-58.17596065151515,-59.26028635858586,-60.34461206565657,-61.428937772727274,-62.51326347979798,-63.59758918686868,-64.68191489393939,-65.7662406010101,-66.8505663080808,-67.93489201515152,-69.01921772222221,-70.10354342929293,-71.18786913636363,-72.27219484343433,-73.35652055050505,-74.44084625757574,-75.52517196464646,-76.60949767171716,-77.69382337878787,-78.77814908585859,-79.86247479292928,-80.9468005,-82.0311262070707,-83.1154519141414,-84.19977762121212,-85.28410332828282,-86.36842903535353,-87.45275474242423,-88.53708044949494,-89.62140615656566,-90.70573186363636,-91.79005757070706,-92.87438327777777,-93.95870898484849,-95.04303469191919,-96.1273603989899,-97.2116861060606,-98.2960118131313,-99.38033752020202,-100.46466322727272,-101.54898893434343,-102.63331464141413,-103.71764034848485,-104.80196605555555,-105.88629176262626,-106.97061746969696,-108.05494317676767,-109.13926888383838,-110.22359459090909,-111.30792029797979,-112.3922460050505,-113.47657171212121,-114.56089741919192,-115.64522312626262,-116.72954883333333,-117.81387454040403,-118.89820024747475,-119.98252595454545,-121.06685166161616,-122.15117736868686,-123.23550307575756,-124.31982878282828,-125.40415448989899,-126.48848019696969,-127.5728059040404,-128.6571316111111,-129.74145731818183,-130.82578302525252,-131.9101087323232,-132.99443443939393,-134.07876014646465)
counts=c(0.3655555555555556, 0.14,0.11888888888888889,0.058888888888888886,0.022222222222222223,0.01888888888888889,0.0044444444444444444,0.008888888888888889,0.008888888888888889,0.011111111111111112,0.008888888888888889,0.0022222222222222222,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0044444444444444444,0.0077777777777777776,0.016666666666666666,0.016666666666666666,0.015555555555555555,0.01,0.01888888888888889,0.013333333333333334,0.0077777777777777776,0.006666666666666667,0.028888888888888888,0.10666666666666667,0.16333333333333333,0.05,0.017777777777777778,0.1111111111111111,0.2722222222222222,0.23444444444444446,0.005555555555555556,0.01888888888888889,0.03111111111111111,0.15777777777777777,0.14,0.04777777777777778,0.006666666666666667,0.08444444444444445,0.16777777777777778,0.29777777777777775,0.15444444444444444,0.15555555555555556,0.12111111111111111,0.10444444444444445,0.022222222222222223,0.01,0.0077777777777777776,0.0033333333333333335,0.0033333333333333335,0.005555555555555556,0.015555555555555555,0.024444444444444446,0.022222222222222223,0.02,0.021111111111111112,0.014444444444444444,0.016666666666666666,0.03111111111111111,0.04,0.06777777777777778,0.07444444444444444,0.06111111111111111,0.042222222222222223,0.016666666666666666,0.016666666666666666,0.008888888888888889,0.0044444444444444444,0.011111111111111112,0.0033333333333333335,0.0022222222222222222,0.0044444444444444444,0.0011111111111111111,0.0011111111111111111,0.0,0.0,0.0011111111111111111,0.0011111111111111111,0.0022222222222222222,0.0,0.0022222222222222222,0.0033333333333333335,0.0077777777777777776,0.04777777777777778,0.11,0.01,0.02,0.022222222222222223,0.07888888888888888,0.15333333333333332,0.5155555555555555,0.06444444444444444,0.0077777777777777776)
plot(mids,counts,type = 'h', xlim = c(-134.620923,-27.272678), ylim=c(0,0.5155555555555555), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-27.809419225, -28.882901675,-29.956384125,-31.029866575,-32.103349025,-33.176831475,-34.250313925,-35.323796375,-36.397278825,-37.470761275,-38.544243725,-39.617726175,-40.691208625,-41.764691075,-42.838173525,-43.911655975,-44.985138425,-46.058620875,-47.132103325,-48.205585775,-49.279068225,-50.352550675,-51.426033125000004,-52.499515575,-53.572998025,-54.646480475,-55.719962925,-56.793445375,-57.866927825,-58.940410275,-60.013892725,-61.087375175,-62.160857625,-63.234340075,-64.30782252499999,-65.38130497499999,-66.45478742499999,-67.52826987499999,-68.60175232499999,-69.67523477499999,-70.748717225,-71.822199675,-72.895682125,-73.969164575,-75.042647025,-76.116129475,-77.189611925,-78.263094375,-79.336576825,-80.410059275,-81.483541725,-82.557024175,-83.630506625,-84.703989075,-85.777471525,-86.850953975,-87.924436425,-88.997918875,-90.071401325,-91.144883775,-92.218366225,-93.291848675,-94.365331125,-95.438813575,-96.512296025,-97.585778475,-98.659260925,-99.732743375,-100.806225825,-101.879708275,-102.953190725,-104.026673175,-105.100155625,-106.173638075,-107.247120525,-108.320602975,-109.394085425,-110.467567875,-111.541050325,-112.614532775,-113.688015225,-114.761497675,-115.834980125,-116.908462575,-117.981945025,-119.055427475,-120.128909925,-121.202392375,-122.275874825,-123.349357275,-124.422839725,-125.496322175,-126.569804625,-127.643287075,-128.71676952500002,-129.790251975,-130.86373442499996,-131.937216875,-133.01069932499996,-134.084181775)
net_rate=c(-0.8744040942923438, -0.2869695711167241,-0.15400146455302732,-0.07206239078404914,-0.040918692553132394,-0.03279985982830871,-0.027177325415946724,-0.02661477803757959,-0.025258676116164325,-0.022387364655424912,-0.021249150394039996,-0.01956343632592889,-0.019281099436573072,-0.019191110502879284,-0.01910748135199202,-0.019048569165146797,-0.018794921863040118,-0.018707070441761158,-0.018688460525349424,-0.01856290203028803,-0.018417604305041628,-0.017284222861129524,-0.01591577020117452,-0.013704453775517022,-0.010869126568968346,-0.006442370441799745,-0.0025660112874315555,0.0017439218232649003,0.007191824313900637,0.013679755616452833,0.029196839418468096,0.05338927800029465,0.07049336720270406,0.055607775285765756,0.05391358331586485,0.03761156137343656,-0.038818032601557674,-0.155786521918645,-0.1603305917625996,-0.13562658149571785,-0.07072171309474531,-0.04407896126577454,-0.1524771482118882,-0.0831138199027342,-0.08286077395599449,-0.07744404247419483,1.284038315340254,0.06293498983333153,-0.1800950490888033,-0.13731545974765474,-0.09459913293404366,-0.06408387689984597,-0.043494100615297716,-0.039848400275432586,-0.037594009205821274,-0.03694622491680032,-0.036202116508120046,-0.03634198471455672,-0.03499432193460923,-0.032793996517335715,-0.02540646845497022,-0.028617157489593415,-0.029254868361342085,-0.0313325871844521,-0.03304859671088636,-0.03358467313660585,-0.03066017891973496,-0.02923753505805275,-0.028202560945107986,-0.026156005419762127,-0.026607914029972368,-0.026038764841393194,-0.025427749753209557,-0.024804314668353773,-0.02435516302068124,-0.023667781932181123,-0.02353261682759816,-0.02316515230886713,-0.023008964120573523,-0.02289943403356277,-0.022663814473582778,-0.022587151914149783,-0.022587151914149783,-0.022509853849956463,-0.021219870586359994,-0.017180415261718398,-0.008391127313003044,0.0220096477815407,0.0478821838353821,0.07927222703596488,0.1569985627819343,0.18461041175038778,0.1924493835755899,0.19941221261922812,0.20042050802840808,0.19417061140689226,0.16288204369322026,0.10000295349494887,-0.1656036286708537,0.1485735466943683)
net_minHPD=c(-2.6972596944603997, -1.2078241283160978,-0.8000302932278778,-0.4314429994510451,-0.21459362980955302,-0.14445608533367177,-0.07397763230821493,-0.07306955895081317,-0.06760925731889032,-0.06453103624819448,-0.057938683807128105,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.056625639457464266,-0.05920082335050119,-0.06676663846889204,-0.07928630517168073,-0.07928630517168073,-0.07225787270099794,-0.06769538723765829,-0.06971828940039967,-0.06505286826009593,-0.06505286826009593,-0.10596876927859167,-0.07303887634622881,-0.11603717291253092,-0.20815040526354983,-0.23914199686266013,-0.23914199686266013,-0.2449756937688134,-0.31441328092232573,-0.39760414804860317,-0.38719708767866545,-0.3925216435253682,-0.2935126403580266,-0.31976442045758713,-0.8909940093783527,-0.27086524878285323,-0.26967676590396794,-0.26157198669353676,0.3493599547036863,-0.736578093399834,-0.44832268325712665,-0.4035379436998976,-0.3488332824747059,-0.3136520394373803,-0.1890333967955648,-0.1656936421521991,-0.15633231824258303,-0.1430947840139546,-0.1430947840139546,-0.1430947840139546,-0.14291548524910538,-0.1364994365454552,-0.1345963720906964,-0.13836918290043665,-0.13836918290043665,-0.13815678831017478,-0.14312380449897988,-0.1590407091341142,-0.13952329424432647,-0.15115945513867599,-0.14042411491490853,-0.1265737686515168,-0.09841116899418713,-0.08037737257331737,-0.07354751048219318,-0.07179479549224,-0.0683974279217232,-0.0683974279217232,-0.0683974279217232,-0.06753303349727256,-0.0683974279217232,-0.06753303349727256,-0.06753303349727256,-0.06753303349727256,-0.06753303349727256,-0.0678191846026728,-0.06895568111250795,-0.0802896170659113,-0.08877137226100865,-0.06550762467331858,-0.05970278750737767,-0.05451658766220421,-0.04590685940180016,-0.045366396496767214,-0.046030913298319265,-0.047906798012044394,-0.06189043808670963,-0.08874304626640941,-0.20388429261108199,-0.32085913335092897,-0.7160924658659229,-0.6226202304968891)
net_maxHPD=c(0.023392719776305033, 0.03281004080970166,0.0321073763573782,0.03611342359858041,0.03611342359858041,0.03611342359858041,0.02905546909714115,0.026885951306301434,0.026885951306301434,0.023680823369008053,0.026305736131215687,0.023392719776305033,0.023112962950484643,0.022865202321201913,0.023112962950484643,0.023392719776305033,0.023112962950484643,0.022865202321201913,0.023112962950484643,0.023392719776305033,0.023680823369008053,0.026492768641066484,0.03823890698777081,0.07135931735742759,0.07187760839772409,0.09199828498449789,0.09536612594531291,0.11076954116747059,0.12016860291690196,0.13327837171775467,0.22532627206451156,0.28701748396050003,0.29033132400758815,0.28919048427078603,0.29419883367537225,0.3079769717146823,0.28919048427078603,0.04687595286492818,0.026749066849892672,0.07221433320860982,0.2300245971989435,0.2922670500802161,0.16641280067840425,0.1254589008956314,0.1194423316363758,0.14573042870940184,2.323883564061936,1.7917183701068333,0.07382407688934958,0.05668561359658694,0.07553015069889042,0.07553015069889042,0.07553015069889042,0.07553015069889042,0.07553015069889042,0.08372835507382614,0.07882562256641826,0.07882562256641826,0.07553015069889042,0.07382407688934958,0.07553015069889042,0.07347758562219926,0.07347758562219926,0.0754007868723663,0.0754007868723663,0.05668814241951059,0.08006104704667527,0.06087267027413895,0.05684297822763873,0.045355687491449526,0.03206776109627382,0.026251628979374317,0.026251628979374317,0.024829739997450605,0.024009291098351544,0.022421262374509476,0.02057739569743871,0.022421262374509476,0.02057739569743871,0.02057739569743871,0.02057739569743871,0.02057739569743871,0.02057739569743871,0.02057739569743871,0.022421262374509476,0.029708734128445845,0.1277798367901359,0.20480232367339826,0.21920140885780925,0.25057378044425493,0.33690652084949924,0.37714668957360403,0.4482605520972449,0.45849026289102346,0.4722049279963825,0.4694274892270158,0.4722049279963825,0.4663504891213463,0.3390316807957805,1.2863496613341978)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-2.96698566390644, 2.55627192046813), xlim = c(-134.620923,-27.272678), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-27.809419225, -28.882901675,-29.956384125,-31.029866575,-32.103349025,-33.176831475,-34.250313925,-35.323796375,-36.397278825,-37.470761275,-38.544243725,-39.617726175,-40.691208625,-41.764691075,-42.838173525,-43.911655975,-44.985138425,-46.058620875,-47.132103325,-48.205585775,-49.279068225,-50.352550675,-51.426033125000004,-52.499515575,-53.572998025,-54.646480475,-55.719962925,-56.793445375,-57.866927825,-58.940410275,-60.013892725,-61.087375175,-62.160857625,-63.234340075,-64.30782252499999,-65.38130497499999,-66.45478742499999,-67.52826987499999,-68.60175232499999,-69.67523477499999,-70.748717225,-71.822199675,-72.895682125,-73.969164575,-75.042647025,-76.116129475,-77.189611925,-78.263094375,-79.336576825,-80.410059275,-81.483541725,-82.557024175,-83.630506625,-84.703989075,-85.777471525,-86.850953975,-87.924436425,-88.997918875,-90.071401325,-91.144883775,-92.218366225,-93.291848675,-94.365331125,-95.438813575,-96.512296025,-97.585778475,-98.659260925,-99.732743375,-100.806225825,-101.879708275,-102.953190725,-104.026673175,-105.100155625,-106.173638075,-107.247120525,-108.320602975,-109.394085425,-110.467567875,-111.541050325,-112.614532775,-113.688015225,-114.761497675,-115.834980125,-116.908462575,-117.981945025,-119.055427475,-120.128909925,-121.202392375,-122.275874825,-123.349357275,-124.422839725,-125.496322175,-126.569804625,-127.643287075,-128.71676952500002,-129.790251975,-130.86373442499996,-131.937216875,-133.01069932499996,-134.084181775)
rate=c(1.1062314091490228, 3.1648379249202545,5.4643662093349015,9.894645150245807,14.299854432158579,16.178101726894905,17.796946383661673,17.992008509936007,18.441974188562007,19.460468340310914,19.901285446898044,20.592106913749944,20.670297696277224,20.702251911392285,20.702251911392285,20.702251911392285,20.735316780544565,20.735316780544565,20.72272483152593,20.709623570278005,20.575707336729963,20.215666875291063,19.696335224831792,18.997733693122253,18.32165295358483,17.962822924731924,17.38137104698956,16.640485522632122,16.340821503897576,16.080556776581595,15.512257118016993,12.098262363245988,8.55656199765989,7.17264530358228,6.980104646681966,6.242810762630791,4.246359676004047,2.8338131418536925,2.7733430650692315,2.753681098847997,2.712596675412613,2.5173207619618223,1.9243264059293401,2.2783435885825756,2.281551915682861,2.2796109125986006,1.8388417711266223,2.567788300019084,3.359410457766955,4.088720163038191,4.9962363992244105,5.898021504375513,6.713274460976144,6.881701256988125,6.981430015016573,7.016610290391584,7.048231137690067,7.0393131220220395,7.09935574389127,7.21201383959758,7.436863654565389,7.526105160372119,7.682282331032223,7.75400953068181,7.8381632107772905,7.963316802126256,8.280544199139602,8.691173881052212,9.33097305077204,10.125381289282043,10.740354582414334,11.097921900398166,11.226490847065445,11.32900161288585,11.40122762621192,11.501697006263896,11.519605708754659,11.572254726535807,11.594864836093132,11.61523842266776,11.627776749879457,11.627776749879457,11.627776749879457,11.63004871524828,11.63004871524828,11.629048998543915,11.606697701741732,11.606697701741732,11.595111573812286,11.556556900215423,11.4363140830372,10.344205265510613,8.417774452787327,8.322087987481822,8.02171719465444,7.605019735608197,6.122857281938061,4.408055505185262,1.9558066261500724,1.824389820778379)
minHPD=c(1.1062314091490228, 3.1648379249202545,5.4643662093349015,9.894645150245807,14.299854432158579,16.178101726894905,17.796946383661673,17.992008509936007,18.441974188562007,19.460468340310914,19.901285446898044,20.592106913749944,20.670297696277224,20.702251911392285,20.702251911392285,20.702251911392285,20.735316780544565,20.735316780544565,20.72272483152593,20.709623570278005,20.575707336729963,20.215666875291063,19.696335224831792,18.997733693122253,18.32165295358483,17.962822924731924,17.38137104698956,16.640485522632122,16.340821503897576,16.080556776581595,15.512257118016993,12.098262363245988,8.55656199765989,7.17264530358228,6.980104646681966,6.242810762630791,4.246359676004047,2.8338131418536925,2.7733430650692315,2.753681098847997,2.712596675412613,2.5173207619618223,1.9243264059293401,2.2783435885825756,2.281551915682861,2.2796109125986006,1.8388417711266223,2.567788300019084,3.359410457766955,4.088720163038191,4.9962363992244105,5.898021504375513,6.713274460976144,6.881701256988125,6.981430015016573,7.016610290391584,7.048231137690067,7.0393131220220395,7.09935574389127,7.21201383959758,7.436863654565389,7.526105160372119,7.682282331032223,7.75400953068181,7.8381632107772905,7.963316802126256,8.280544199139602,8.691173881052212,9.33097305077204,10.125381289282043,10.740354582414334,11.097921900398166,11.226490847065445,11.32900161288585,11.40122762621192,11.501697006263896,11.519605708754659,11.572254726535807,11.594864836093132,11.61523842266776,11.627776749879457,11.627776749879457,11.627776749879457,11.63004871524828,11.63004871524828,11.629048998543915,11.606697701741732,11.606697701741732,11.595111573812286,11.556556900215423,11.4363140830372,10.344205265510613,8.417774452787327,8.322087987481822,8.02171719465444,7.605019735608197,6.122857281938061,4.408055505185262,1.9558066261500724,1.824389820778379)
maxHPD=c(1.1062314091490228, 3.1648379249202545,5.4643662093349015,9.894645150245807,14.299854432158579,16.178101726894905,17.796946383661673,17.992008509936007,18.441974188562007,19.460468340310914,19.901285446898044,20.592106913749944,20.670297696277224,20.702251911392285,20.702251911392285,20.702251911392285,20.735316780544565,20.735316780544565,20.72272483152593,20.709623570278005,20.575707336729963,20.215666875291063,19.696335224831792,18.997733693122253,18.32165295358483,17.962822924731924,17.38137104698956,16.640485522632122,16.340821503897576,16.080556776581595,15.512257118016993,12.098262363245988,8.55656199765989,7.17264530358228,6.980104646681966,6.242810762630791,4.246359676004047,2.8338131418536925,2.7733430650692315,2.753681098847997,2.712596675412613,2.5173207619618223,1.9243264059293401,2.2783435885825756,2.281551915682861,2.2796109125986006,1.8388417711266223,2.567788300019084,3.359410457766955,4.088720163038191,4.9962363992244105,5.898021504375513,6.713274460976144,6.881701256988125,6.981430015016573,7.016610290391584,7.048231137690067,7.0393131220220395,7.09935574389127,7.21201383959758,7.436863654565389,7.526105160372119,7.682282331032223,7.75400953068181,7.8381632107772905,7.963316802126256,8.280544199139602,8.691173881052212,9.33097305077204,10.125381289282043,10.740354582414334,11.097921900398166,11.226490847065445,11.32900161288585,11.40122762621192,11.501697006263896,11.519605708754659,11.572254726535807,11.594864836093132,11.61523842266776,11.627776749879457,11.627776749879457,11.627776749879457,11.63004871524828,11.63004871524828,11.629048998543915,11.606697701741732,11.606697701741732,11.595111573812286,11.556556900215423,11.4363140830372,10.344205265510613,8.417774452787327,8.322087987481822,8.02171719465444,7.605019735608197,6.122857281938061,4.408055505185262,1.9558066261500724,1.824389820778379)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 22.808848458599023), xlim = c(-134.620923,-27.272678), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()