

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/reptilia/mcmc_predictors/B_covar_rjmcmc/B_covar_rep_RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2), 
    oma=c(0,0,3,0),     # Increased top outer margin from 2 to 3
    mar=c(5,5,4,2)+0.1, # Increase plot margins for larger axis labels
    cex.lab=1.5,        # Increase axis label size
    cex.axis=1.2)       # Increase axis tick label size
library(scales)

time=c(-24.947788394999996, -25.936745185,-26.925701974999996,-27.914658765,-28.903615554999995,-29.892572344999998,-30.881529135,-31.870485924999997,-32.859442715,-33.848399504999996,-34.837356295,-35.826313084999995,-36.815269875,-37.804226665,-38.793183455,-39.782140244999994,-40.771097035,-41.760053825,-42.749010614999996,-43.73796740499999,-44.726924194999995,-45.715880985,-46.704837775,-47.693794565,-48.68275135499999,-49.671708145,-50.660664935,-51.649621725,-52.638578515,-53.627535304999995,-54.616492095,-55.605448885,-56.594405675000004,-57.58336246499999,-58.572319255,-59.561276045,-60.550232835,-61.53918962499999,-62.528146414999995,-63.517103205,-64.506059995,-65.495016785,-66.483973575,-67.472930365,-68.461887155,-69.450843945,-70.43980073499999,-71.428757525,-72.417714315,-73.406671105,-74.395627895,-75.384584685,-76.373541475,-77.362498265,-78.351455055,-79.340411845,-80.329368635,-81.318325425,-82.307282215,-83.296239005,-84.28519579499999,-85.274152585,-86.263109375,-87.252066165,-88.241022955,-89.22997974500001,-90.218936535,-91.207893325,-92.196850115,-93.185806905,-94.174763695,-95.163720485,-96.152677275,-97.141634065,-98.13059085500001,-99.119547645,-100.108504435,-101.097461225,-102.086418015,-103.075374805,-104.064331595,-105.053288385,-106.042245175,-107.03120196500001,-108.020158755,-109.009115545,-109.998072335,-110.987029125,-111.97598591500001,-112.964942705,-113.953899495,-114.942856285,-115.93181307500001,-116.920769865,-117.909726655,-118.898683445,-119.887640235,-120.87659702500001,-121.865553815,-122.854510605)
rate=c(0.35438345478310795, 0.41646084280528944,0.5017864811990584,0.05641253087327537,0.05605283610542913,0.05605283610542913,0.05605283610542913,0.05605283610542913,0.05605283610542913,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.056044333561535827,0.05605283610542913,0.05605283610542913,0.05605283610542913,0.05605283610542913,0.05605667249493536,0.05644813443762313,0.058419287221291964,0.06380623066209126,0.17570138756303194,0.1831116129836988,0.1824770782802587,0.18175449415258382,0.18175449415258382,0.18179367728273627,0.1824770782802587,0.18359630233438295,0.1849049655566166,0.1865228323474596,0.18944103561293513,0.19595026055189999,0.19032331013483506,0.19032331013483506,0.19030685606122616,0.19030685606122616,0.1903499839090751,0.1903499839090751,0.1903499839090751,0.1903499839090751,0.1942496279367476,0.7722452789023566,0.7261632842531578,0.6782453792021617,0.6757862702819096,0.770931497154913,0.9130573868282834,0.20684276684285827,0.20157878778131766,0.20150566830320538,0.20150566830320538,0.20150566830320538,0.20127740043245226,0.2019981608635643,0.20157878778131766,0.20127740043245226,0.20127740043245226,0.20127740043245226,0.20097300578159277,0.20046195282792667,0.1973568227057378,0.19337257859529855,0.19031694739616956,0.18678897780712111,0.18465482509989395,0.18259703557925777,0.18057791681756574,0.17701957005800872,0.17366268162676896,0.16856788693340907,0.16455178727779063,0.16288459889379237,0.1618914755830877,0.1616040173376465,0.16127486338301236,0.16127486338301236,0.16127486338301236,0.16212026941480562,0.16311329079637066,0.1632625580740602,0.1632625580740602,0.16387454911435653,0.16410191749245634,0.16728395547682878,0.18902946407887244,0.523039157027096,0.5364181630186392,0.5299816635383843,0.5273003327061271,0.5235608251672149,0.523039157027096,0.5235608251672149,0.5311731909524942)
minHPD=c(0.0032858974427394513, 0.009084228422189998,0.265409714829988,0.03892121422523829,0.04589718750541407,0.04589718750541407,0.04589718750541407,0.04589718750541407,0.04589718750541407,0.045198480005785094,0.045198480005785094,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.04529018692695921,0.045198480005785094,0.039503529176050704,0.04437646727974333,0.04600610822727924,0.05116553081541222,0.10198305280822773,0.11259714383431975,0.11259714383431975,0.11259714383431975,0.11259714383431975,0.11378815150420668,0.11825108407544117,0.11409657284860182,0.11091101492123406,0.11480994850882595,0.14759956817331124,0.16049679892498084,0.16049679892498084,0.16012874452603976,0.16012874452603976,0.16049679892498084,0.16049679892498084,0.16049679892498084,0.16012874452603976,0.14759956817331124,0.41298943752302425,0.30084971624841694,0.24145159194602991,0.24145159194602991,0.2853842457539174,0.6244337691626327,0.12928626763695963,0.13893737195449982,0.13893737195449982,0.13893737195449982,0.13893737195449982,0.13893737195449982,0.13893737195449982,0.13893737195449982,0.13893737195449982,0.1384295658722028,0.1384295658722028,0.1372252185066352,0.1384295658722028,0.12928626763695963,0.10708867356022202,0.08801712229495276,0.08539999717323196,0.08801712229495276,0.07010527590731044,0.060126562802032976,0.060126562802032976,0.060126562802032976,0.060126562802032976,0.060126562802032976,0.060126562802032976,0.05236067011173581,0.05236067011173581,0.05236067011173581,0.0592781570917436,0.0592781570917436,0.0592781570917436,0.06147584540869917,0.061004302540835866,0.061004302540835866,0.0592781570917436,0.0592781570917436,0.03191236214235307,0.0513856200058673,0.0770207544868937,0.1280920757395401,0.14763121585510755,0.1440773539717156,0.1440773539717156,0.1440773539717156,0.1440773539717156,0.1440773539717156)
maxHPD=c(0.5733807907124188, 0.7697904172869261,1.011420411486347,0.2829228799398294,0.06964349873465218,0.06964349873465218,0.06964349873465218,0.06964349873465218,0.06964349873465218,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06890304047385064,0.06964349873465218,0.11411576187492437,0.18436104879166357,0.1953376196092192,0.21626819299466338,0.22757396182787049,0.2232803771548409,0.2232803771548409,0.2232803771548409,0.2232803771548409,0.2232803771548409,0.22716008539547805,0.2257238742768763,0.2403623606306336,0.5257934133268014,0.9875691536687982,0.22837948979968126,0.22837948979968126,0.22757396182787049,0.22757396182787049,0.22837948979968126,0.22837948979968126,0.22837948979968126,0.23091642937953624,0.5761390712661218,1.2225326522731577,0.9997786612298885,0.9153441797150165,0.9262795904869856,1.7292489628545449,2.058150346441137,0.7095128964446421,0.286682840039864,0.286682840039864,0.286682840039864,0.286682840039864,0.286682840039864,0.28702509439541896,0.28702509439541896,0.28702509439541896,0.28702509439541896,0.28702509439541896,0.28702509439541896,0.2912417924367152,0.29861348178429437,0.28659450647193185,0.27574475730293607,0.2769521484541187,0.2769521484541187,0.26222159488482594,0.24859937875850913,0.24438843528051513,0.24319445884655935,0.23880473465431915,0.23832405847838184,0.23880473465431915,0.23093554489504578,0.23093554489504578,0.23093554489504578,0.23588970647027532,0.23588970647027532,0.23093554489504578,0.23093554489504578,0.23081406373994232,0.2317548093577608,0.23242689905845912,0.2348996689610432,0.2613717666738255,0.8051295129802226,1.2440893017574923,1.2021998100103886,1.1586912110127046,1.1426423450058305,1.14074552614495,1.1284598212176582,1.14074552614495,1.1426423450058305)
remove_na = !is.na(rate)
time = time[remove_na]
time=time-175
plot(time,time,type = 'n', ylim = c(0, 2.263965381085251), xlim = c(-123.348989-175,-24.45331-175), ylab = 'Speciation rate', xlab = 'Time',main='Speciation' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mtext("Reptilia CoVar RJMCMC RTT Plots (Combined 10 Replicates)", outer = TRUE, line = 0.5, cex = 1.5, font = 2)
mids=c(-24.952783126262624, -25.951729378787874,-26.950675631313132,-27.949621883838383,-28.948568136363633,-29.947514388888884,-30.94646064141414,-31.945406893939392,-32.94435314646464,-33.94329939898989,-34.94224565151515,-35.9411919040404,-36.94013815656565,-37.9390844090909,-38.93803066161615,-39.93697691414141,-40.93592316666666,-41.93486941919191,-42.93381567171717,-43.93276192424242,-44.93170817676767,-45.93065442929293,-46.92960068181817,-47.92854693434343,-48.92749318686868,-49.92643943939393,-50.92538569191919,-51.92433194444444,-52.92327819696969,-53.92222444949495,-54.92117070202019,-55.92011695454545,-56.91906320707071,-57.91800945959595,-58.91695571212121,-59.915901964646466,-60.91484821717171,-61.91379446969697,-62.91274072222221,-63.91168697474747,-64.91063322727273,-65.90957947979797,-66.90852573232323,-67.90747198484848,-68.90641823737373,-69.90536448989899,-70.90431074242423,-71.90325699494949,-72.90220324747474,-73.90114949999999,-74.90009575252525,-75.8990420050505,-76.89798825757575,-77.896934510101,-78.89588076262626,-79.8948270151515,-80.89377326767676,-81.89271952020201,-82.89166577272726,-83.89061202525252,-84.88955827777777,-85.88850453030302,-86.88745078282828,-87.88639703535353,-88.88534328787878,-89.88428954040404,-90.88323579292928,-91.88218204545454,-92.8811282979798,-93.88007455050504,-94.8790208030303,-95.87796705555556,-96.8769133080808,-97.87585956060606,-98.8748058131313,-99.87375206565656,-100.87269831818182,-101.87164457070706,-102.87059082323232,-103.86953707575758,-104.86848332828282,-105.86742958080808,-106.86637583333334,-107.86532208585858,-108.86426833838384,-109.86321459090908,-110.86216084343434,-111.8611070959596,-112.86005334848484,-113.8589996010101,-114.85794585353536,-115.8568921060606,-116.85583835858586,-117.8547846111111,-118.85373086363636,-119.85267711616162,-120.85162336868686,-121.85056962121212,-122.84951587373737)
mids=mids-175
counts=c(0.14555555555555555, 0.2722222222222222,0.9266666666666666,0.05555555555555555,0.0,0.0,0.0,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0,0.0011111111111111111,0.0,0.0,0.0,0.0,0.0011111111111111111,0.0,0.0,0.0011111111111111111,0.013333333333333334,0.052222222222222225,0.16444444444444445,0.29444444444444445,0.3655555555555556,0.10555555555555556,0.034444444444444444,0.014444444444444444,0.0011111111111111111,0.0033333333333333335,0.012222222222222223,0.03888888888888889,0.02666666666666667,0.04555555555555556,0.16555555555555557,0.18777777777777777,0.011111111111111112,0.0011111111111111111,0.0011111111111111111,0.0011111111111111111,0.0,0.0,0.0022222222222222222,0.021111111111111112,0.4066666666666667,0.5755555555555556,0.18888888888888888,0.06222222222222222,0.04888888888888889,0.4166666666666667,0.7244444444444444,0.28,0.012222222222222223,0.0,0.0022222222222222222,0.0011111111111111111,0.0022222222222222222,0.0022222222222222222,0.0022222222222222222,0.0044444444444444444,0.0011111111111111111,0.0044444444444444444,0.006666666666666667,0.025555555555555557,0.03666666666666667,0.044444444444444446,0.03222222222222222,0.03,0.022222222222222223,0.017777777777777778,0.03777777777777778,0.04888888888888889,0.051111111111111114,0.043333333333333335,0.013333333333333334,0.011111111111111112,0.008888888888888889,0.0022222222222222222,0.005555555555555556,0.0022222222222222222,0.01,0.012222222222222223,0.0011111111111111111,0.0022222222222222222,0.006666666666666667,0.0044444444444444444,0.03777777777777778,0.1811111111111111,0.43333333333333335,0.028888888888888888,0.014444444444444444,0.0044444444444444444,0.008888888888888889,0.01,0.011111111111111112,0.013333333333333334,0.012222222222222223)
plot(mids,counts,type = 'h', xlim = c(-123.348989-175,-24.45331-175), ylim=c(0,0.9266666666666666), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03403432998103777
bf6 = 0.20656465802041962
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-24.947788394999996, -25.936745185,-26.925701974999996,-27.914658765,-28.903615554999995,-29.892572344999998,-30.881529135,-31.870485924999997,-32.859442715,-33.848399504999996,-34.837356295,-35.826313084999995,-36.815269875,-37.804226665,-38.793183455,-39.782140244999994,-40.771097035,-41.760053825,-42.749010614999996,-43.73796740499999,-44.726924194999995,-45.715880985,-46.704837775,-47.693794565,-48.68275135499999,-49.671708145,-50.660664935,-51.649621725,-52.638578515,-53.627535304999995,-54.616492095,-55.605448885,-56.594405675000004,-57.58336246499999,-58.572319255,-59.561276045,-60.550232835,-61.53918962499999,-62.528146414999995,-63.517103205,-64.506059995,-65.495016785,-66.483973575,-67.472930365,-68.461887155,-69.450843945,-70.43980073499999,-71.428757525,-72.417714315,-73.406671105,-74.395627895,-75.384584685,-76.373541475,-77.362498265,-78.351455055,-79.340411845,-80.329368635,-81.318325425,-82.307282215,-83.296239005,-84.28519579499999,-85.274152585,-86.263109375,-87.252066165,-88.241022955,-89.22997974500001,-90.218936535,-91.207893325,-92.196850115,-93.185806905,-94.174763695,-95.163720485,-96.152677275,-97.141634065,-98.13059085500001,-99.119547645,-100.108504435,-101.097461225,-102.086418015,-103.075374805,-104.064331595,-105.053288385,-106.042245175,-107.03120196500001,-108.020158755,-109.009115545,-109.998072335,-110.987029125,-111.97598591500001,-112.964942705,-113.953899495,-114.942856285,-115.93181307500001,-116.920769865,-117.909726655,-118.898683445,-119.887640235,-120.87659702500001,-121.865553815,-122.854510605)
rate=c(6.462548680783932, 0.4101798861211283,0.41251479678454606,0.24387035935835968,0.15898377269178024,0.11789319614222267,0.11645423012005901,0.11634521645563284,0.12066157478907619,0.37169935124029435,0.20738240109528444,0.059074850055962434,0.05534043308434247,0.05526283146479409,0.0549990023592129,0.05309320498827272,0.0520492022917632,0.05160607824851712,0.05111636333084829,0.050800352311925034,0.050716705042145885,0.0505454537909658,0.050486788275316455,0.0505454537909658,0.0505454537909658,0.0506188315598045,0.05111636333084829,0.06362735857201379,0.10533408695092514,0.10206780623424136,0.09949283568588141,0.0989616124847266,0.09878202271729422,0.09878202271729422,0.09878202271729422,0.09934219499150496,0.10676587082720446,0.22112499366185914,0.2790060671462553,0.26175635972156663,0.24685879499320817,0.24636185119676235,0.25086452968214634,0.273663959511811,0.2724207715888971,0.2677049798102974,0.22505893891623896,0.21217842227694214,0.26374652942869836,0.434021409846746,0.43008456932590844,0.43008456932590844,0.4604041225675065,0.46946555752638935,0.4285563442645869,0.34266435908317716,0.214474975343882,0.1715829872276327,0.1681030069815882,0.16607345044349853,0.1648078777121199,0.16186486547968448,0.15356877326436028,0.15143871398647213,0.15116769653872913,0.15116769653872913,0.15067253747826573,0.14992961270143706,0.1493224172551479,0.1491703576945585,0.1489030734704189,0.1487456911042792,0.14858435532138387,0.14852024275221698,0.1482516949657886,0.1482066847677378,0.14779206183600924,0.14754093644678024,0.14734571711022837,0.1472661970618319,0.1472661970618319,0.1472661970618319,0.1472661970618319,0.1472661970618319,0.1472661970618319,0.14754093644678024,0.14671178250707867,0.1458272700657614,0.14553137903705754,0.1453347189861966,0.1453347189861966,0.14548636140399676,0.14550909876353058,0.14552010750651373,0.1457466892769647,0.14579913741513081,0.1457466892769647,0.1458272700657614,0.14594128882606244,0.1459901661755013)
minHPD=c(3.0973032691855327, 0.1554875843514911,0.1551306830185008,0.05524278058226806,0.04110691204647333,0.03311411997587634,0.03299851506674207,0.03299851506674207,0.01985052594481233,0.09214703219177528,0.03713617561297095,0.03673821342361367,0.03673821342361367,0.034898382642732005,0.0318817449887872,0.029525488930077677,0.029345590515708193,0.030993557231463444,0.0318817449887872,0.032230967264175424,0.03238827248272614,0.0318817449887872,0.0318817449887872,0.03156986447307411,0.03156986447307411,0.03038870568904082,0.02729551441270259,0.029525488930077677,0.050820547684070634,0.05016841363781188,0.052349173549168945,0.05545944746733566,0.05545944746733566,0.05545944746733566,0.05545944746733566,0.05272261297841326,0.05545944746733566,0.05545944746733566,0.12115133775256409,0.06827702797479968,0.074389040413002,0.07190388142577366,0.06347154770411705,0.17625112143823554,0.17994377407471204,0.11472228648383215,0.06498944972920309,0.05928409430188948,0.0526935653238597,0.2304839361781407,0.23637860700441948,0.23637860700441948,0.2304839361781407,0.22673695933543467,0.12150064796265543,0.12741422393404497,0.12150064796265543,0.11474173465309025,0.11543163913254058,0.1100798856266341,0.11358762079697765,0.10745746949828543,0.09668238070620981,0.09668238070620981,0.09668238070620981,0.09668238070620981,0.0966019598875009,0.0966019598875009,0.09153195907391487,0.09400308348837863,0.09400308348837863,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.09723251674067748,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.0966019598875009,0.09097563741533762,0.0925189317297032,0.08780393603156823,0.08742488141511612,0.08464176305447599,0.08464176305447599,0.08464176305447599,0.08432004949939387,0.08432004949939387,0.07371686816366858,0.0721007486548869,0.062184489044197135,0.062184489044197135,0.062184489044197135,0.05108814839796828)
maxHPD=c(11.299991798618674, 0.7060965994018205,0.7094164748122501,0.5955136726327254,0.4504738672848236,0.25984692862320885,0.2592155296065752,0.2592155296065752,0.26771305136929835,0.770233239112583,0.5139786494969315,0.2237080251146768,0.16047483354066602,0.157075117113799,0.1400269912080844,0.10908332187176516,0.07730874347648586,0.07583602673547182,0.07524717919012577,0.07495371587105695,0.07495371587105695,0.07495371587105695,0.07495371587105695,0.07524717919012577,0.07552176343235996,0.07495371587105695,0.08025655769366624,0.12662351112282394,0.24192627805368444,0.1717406026520028,0.14019038619713048,0.13902047056489392,0.13819298807416158,0.13819298807416158,0.13839229112285117,0.1472867254071199,0.2751866357583287,0.3068119932097128,0.963591282937176,0.5911489008329478,0.32030046728793315,0.31564835055839746,0.32030046728793315,0.5112507812918612,0.5096515401118075,0.4540281327810999,0.3022759519398053,0.30086153461094317,0.5311885078033377,0.5770904856218274,0.5770904856218274,0.5770904856218274,0.9008153760591663,1.1224995977188092,0.732806091444552,0.5596366309656102,0.5255184541695104,0.42107672338571345,0.40724422070535204,0.39605143296312867,0.39605143296312867,0.38555833676743173,0.27742536966749703,0.24342920374579513,0.23648307516659148,0.23557225058963321,0.23114877496962702,0.22143281581026075,0.20797688823651042,0.2069837282027177,0.20141615880152633,0.20118621568911807,0.20118621568911807,0.20118621568911807,0.20118621568911807,0.20141615880152633,0.20060252473763251,0.20060252473763251,0.20060252473763251,0.20036702514277435,0.20036702514277435,0.20036702514277435,0.20036702514277435,0.20036702514277435,0.20141615880152633,0.20141615880152633,0.20141615880152633,0.20060252473763251,0.20060252473763251,0.20060252473763251,0.20060252473763251,0.20060252473763251,0.20141615880152633,0.20725536690827986,0.20725536690827986,0.2069837282027177,0.20060252473763251,0.20118621568911807,0.20060252473763251,0.20141615880152633)
remove_na = !is.na(rate)
time = time[remove_na]
time=time-175
plot(time,time,type = 'n', ylim = c(0, 12.429990978480543), xlim = c(-123.348989-175,-24.45331-175), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-24.952783126262624, -25.951729378787874,-26.950675631313132,-27.949621883838383,-28.948568136363633,-29.947514388888884,-30.94646064141414,-31.945406893939392,-32.94435314646464,-33.94329939898989,-34.94224565151515,-35.9411919040404,-36.94013815656565,-37.9390844090909,-38.93803066161615,-39.93697691414141,-40.93592316666666,-41.93486941919191,-42.93381567171717,-43.93276192424242,-44.93170817676767,-45.93065442929293,-46.92960068181817,-47.92854693434343,-48.92749318686868,-49.92643943939393,-50.92538569191919,-51.92433194444444,-52.92327819696969,-53.92222444949495,-54.92117070202019,-55.92011695454545,-56.91906320707071,-57.91800945959595,-58.91695571212121,-59.915901964646466,-60.91484821717171,-61.91379446969697,-62.91274072222221,-63.91168697474747,-64.91063322727273,-65.90957947979797,-66.90852573232323,-67.90747198484848,-68.90641823737373,-69.90536448989899,-70.90431074242423,-71.90325699494949,-72.90220324747474,-73.90114949999999,-74.90009575252525,-75.8990420050505,-76.89798825757575,-77.896934510101,-78.89588076262626,-79.8948270151515,-80.89377326767676,-81.89271952020201,-82.89166577272726,-83.89061202525252,-84.88955827777777,-85.88850453030302,-86.88745078282828,-87.88639703535353,-88.88534328787878,-89.88428954040404,-90.88323579292928,-91.88218204545454,-92.8811282979798,-93.88007455050504,-94.8790208030303,-95.87796705555556,-96.8769133080808,-97.87585956060606,-98.8748058131313,-99.87375206565656,-100.87269831818182,-101.87164457070706,-102.87059082323232,-103.86953707575758,-104.86848332828282,-105.86742958080808,-106.86637583333334,-107.86532208585858,-108.86426833838384,-109.86321459090908,-110.86216084343434,-111.8611070959596,-112.86005334848484,-113.8589996010101,-114.85794585353536,-115.8568921060606,-116.85583835858586,-117.8547846111111,-118.85373086363636,-119.85267711616162,-120.85162336868686,-121.85056962121212,-122.84951587373737)
mids=mids-175
counts=c(1.0, 0.014444444444444444,0.26,0.2777777777777778,0.14888888888888888,0.013333333333333334,0.0044444444444444444,0.06111111111111111,0.5511111111111111,0.3877777777777778,0.43,0.10555555555555556,0.0022222222222222222,0.014444444444444444,0.06,0.043333333333333335,0.016666666666666666,0.013333333333333334,0.01,0.005555555555555556,0.006666666666666667,0.0022222222222222222,0.0033333333333333335,0.0011111111111111111,0.0044444444444444444,0.06888888888888889,0.4411111111111111,0.25,0.07111111111111111,0.03111111111111111,0.01,0.0022222222222222222,0.0022222222222222222,0.005555555555555556,0.06,0.2511111111111111,0.48444444444444446,0.19555555555555557,0.23222222222222222,0.044444444444444446,0.0077777777777777776,0.09888888888888889,0.13555555555555557,0.04111111111111111,0.20666666666666667,0.19333333333333333,0.025555555555555557,0.6822222222222222,0.014444444444444444,0.006666666666666667,0.013333333333333334,0.15222222222222223,0.05,0.23777777777777778,0.15555555555555556,0.22,0.08,0.021111111111111112,0.016666666666666666,0.0077777777777777776,0.11555555555555555,0.08,0.014444444444444444,0.005555555555555556,0.005555555555555556,0.013333333333333334,0.012222222222222223,0.005555555555555556,0.006666666666666667,0.005555555555555556,0.0022222222222222222,0.0,0.0022222222222222222,0.0022222222222222222,0.005555555555555556,0.006666666666666667,0.0044444444444444444,0.0033333333333333335,0.0011111111111111111,0.0011111111111111111,0.0,0.0,0.0033333333333333335,0.01,0.011111111111111112,0.01888888888888889,0.008888888888888889,0.0044444444444444444,0.0011111111111111111,0.0044444444444444444,0.0022222222222222222,0.0044444444444444444,0.0077777777777777776,0.0022222222222222222,0.0033333333333333335,0.0022222222222222222,0.005555555555555556,0.008888888888888889,0.0022222222222222222)
plot(mids,counts,type = 'h', xlim = c(-123.348989-175,-24.45331-175), ylim=c(0,1.0), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-24.947788394999996, -25.936745185,-26.925701974999996,-27.914658765,-28.903615554999995,-29.892572344999998,-30.881529135,-31.870485924999997,-32.859442715,-33.848399504999996,-34.837356295,-35.826313084999995,-36.815269875,-37.804226665,-38.793183455,-39.782140244999994,-40.771097035,-41.760053825,-42.749010614999996,-43.73796740499999,-44.726924194999995,-45.715880985,-46.704837775,-47.693794565,-48.68275135499999,-49.671708145,-50.660664935,-51.649621725,-52.638578515,-53.627535304999995,-54.616492095,-55.605448885,-56.594405675000004,-57.58336246499999,-58.572319255,-59.561276045,-60.550232835,-61.53918962499999,-62.528146414999995,-63.517103205,-64.506059995,-65.495016785,-66.483973575,-67.472930365,-68.461887155,-69.450843945,-70.43980073499999,-71.428757525,-72.417714315,-73.406671105,-74.395627895,-75.384584685,-76.373541475,-77.362498265,-78.351455055,-79.340411845,-80.329368635,-81.318325425,-82.307282215,-83.296239005,-84.28519579499999,-85.274152585,-86.263109375,-87.252066165,-88.241022955,-89.22997974500001,-90.218936535,-91.207893325,-92.196850115,-93.185806905,-94.174763695,-95.163720485,-96.152677275,-97.141634065,-98.13059085500001,-99.119547645,-100.108504435,-101.097461225,-102.086418015,-103.075374805,-104.064331595,-105.053288385,-106.042245175,-107.03120196500001,-108.020158755,-109.009115545,-109.998072335,-110.987029125,-111.97598591500001,-112.964942705,-113.953899495,-114.942856285,-115.93181307500001,-116.920769865,-117.909726655,-118.898683445,-119.887640235,-120.87659702500001,-121.865553815,-122.854510605)
net_rate=c(-6.357698664624905, -0.007595803868066074,0.1670902211703352,-0.22275697322782023,-0.12824984703908043,-0.07824025324069168,-0.07669061339595197,-0.07639486251323413,-0.08539645388222479,-0.3377173096869663,-0.17426779118892027,-0.034021020102518215,-0.010809100279656222,-0.010381383247179162,-0.008970197639229323,-0.002150629909515364,0.0017949116950020073,0.0030169080993207023,0.003816775073905618,0.00444393441336488,0.0047151951847576356,0.005015157809338472,0.005016851556579734,0.005545751096232839,0.01066279651528117,0.024432898032621716,0.04985175737313474,0.08686822616940555,0.06547506277588108,0.07109759383574586,0.07569518769630729,0.0770545998740985,0.07757660695910236,0.07872182542749122,0.08105216772996056,0.08131277651542823,0.06470087931471408,0.029646032210322408,-0.07362446819130941,-0.0821470359472221,-0.033337032571337744,-0.03159204123465305,-0.04036906079377758,-0.1106094432185796,-0.1033006984384301,-0.08950024374155693,-0.005603102845553641,0.04809504355356355,0.5142589831721361,0.2845587599096317,0.21937336113145509,0.21560776714190233,0.3619087103021543,0.6493570874608866,-0.1690489719261791,-0.12838307663479404,-0.06066757609713799,-0.0060346595290258695,0.0011625668655471833,0.004990562899826988,0.008244444334266904,0.015550321935145852,0.042118656835272564,0.0509057856907778,0.05211757111592347,0.05261789777583349,0.052770143340835116,0.04850882205349987,0.043851006102428744,0.03884639405116139,0.03455072263326589,0.03194127179782261,0.029215664435622665,0.027084313780114593,0.02203026757942376,0.015067948127073346,0.009553623917205796,0.0053474338372136955,0.004029560554352356,0.0026777661908384412,0.0024912084708337326,0.002289922418379879,0.002717807024510927,0.002677596731784597,0.002629077839569258,-0.002353301175014145,0.006050403332548584,0.010616419859835741,0.012085721702348949,0.013646041082977128,0.026097801388405593,0.1447378510859955,0.42382805834257653,0.4240732274664293,0.410557360381045,0.4074006933116462,0.40231465114743314,0.3999171612561765,0.40155279227113133,0.4083340644570916)
net_minHPD=c(-10.788701499018732, -0.5745518660502668,-0.2877686419740365,-0.5941391188205313,-0.3902601500699367,-0.20652015277211688,-0.20066381545220485,-0.20066381545220485,-0.21650174479874723,-0.7197918784466403,-0.4587948774536013,-0.16731778665381064,-0.09633048128656521,-0.09633048128656521,-0.08171057408075252,-0.05145115391887414,-0.026050947924306553,-0.022887045108904096,-0.01963868508386745,-0.01986445029950988,-0.01986445029950988,-0.01986445029950988,-0.01986445029950988,-0.01986445029950988,-0.02602831315065826,-0.021393685527187442,-0.023777648084258293,-0.04292421939342379,-0.10365004949585083,-0.0366890081807274,0.00866399096779441,0.00866399096779441,0.008828289742659257,0.0188605318404646,0.02006152748701219,0.008828289742659257,-0.10798121242788672,-0.1845207406378718,-0.47881063318823935,-0.38915579844469705,-0.1310742249965146,-0.1310742249965146,-0.1368443570203142,-0.3223026379417807,-0.31808467521830064,-0.2831922238517347,-0.1254707254377552,-0.1221775275304359,0.13322022072509854,-0.13177304985165988,-0.17309614049330002,-0.1822395191916107,-0.296461880652791,0.06080628581076619,-0.6941185790068838,-0.39041302415109125,-0.3512076740427303,-0.22992593943755246,-0.20918108556889767,-0.20259022048779765,-0.20918108556889767,-0.2017027252658253,-0.08279520817092961,-0.04116803703369634,-0.037835459822765455,-0.040185413267272346,-0.043554364325317396,-0.045952158938774246,-0.04948165746621731,-0.06341339697310829,-0.09892154729727062,-0.09526060350179204,-0.09191017798909716,-0.09191017798909716,-0.09191017798909716,-0.10270497104965903,-0.10812972486204557,-0.10791543168620596,-0.10812972486204557,-0.10973080553757926,-0.10973080553757926,-0.10973080553757926,-0.10812972486204557,-0.10812972486204557,-0.10230774472024487,-0.10230774472024487,-0.09935677988916591,-0.09935677988916591,-0.09935677988916591,-0.09892154729727062,-0.1275975648780568,-0.12070663362864656,-0.06310927287041132,-0.02701773256299439,-0.0315179724635411,-0.0315179724635411,-0.0315179724635411,-0.0315179724635411,-0.02701773256299439,-0.0315179724635411)
net_maxHPD=c(-2.4243586918705127, 0.4248118388439022,0.6595493761961844,0.08698992664457655,0.02436145537431491,0.02245446921867246,0.026960807125481448,0.026960807125481448,0.032062211977714666,-0.03512914072471163,0.017423502098547317,0.024849851161991177,0.029645977210530056,0.025362341857052682,0.031075459425524782,0.031075459425524782,0.029073266419453264,0.029073266419453264,0.031075459425524782,0.028752233820488658,0.028403512839305665,0.028403512839305665,0.028403512839305665,0.031075459425524782,0.06260966922119247,0.1395211782251814,0.153461518649188,0.17566998487022095,0.15108374795608184,0.15108374795608184,0.14807651370055508,0.1422419705224799,0.14181752763777514,0.14915435170275354,0.14915435170275354,0.15256979483909813,0.15146008798662153,0.48580741587030246,0.3682961824119566,0.1294004897116474,0.12794906131192157,0.12773295768954046,0.13726943547161619,0.017236537196512663,0.017236537196512663,0.05487523374603695,0.12907744856534767,0.3256103467522631,1.0491944255849077,0.6525286901667786,0.5381913829075036,0.5475522349715127,1.3480575013983032,1.6135532641655397,0.34161215148487273,0.11189985681239867,0.12240677111367204,0.13315792575361607,0.13315792575361607,0.13545563947742342,0.13545563947742342,0.14207577384002973,0.16328982607685621,0.16328982607685621,0.16180752155187297,0.16180752155187297,0.16180752155187297,0.16454481087978073,0.16169813559064963,0.15685617380329447,0.12293567251430279,0.12167706469608788,0.1262251248511197,0.12397319314442017,0.12293567251430279,0.12397319314442017,0.11269109825393807,0.11041398942994687,0.11041398942994687,0.11041398942994687,0.11041398942994687,0.11041398942994687,0.11041398942994687,0.11041398942994687,0.11269109825393807,0.11694838674295652,0.11269109825393807,0.11634128603330929,0.1203144783485849,0.1232406405036123,0.15744343598891963,0.6607267250623733,1.1067979835547388,1.0732119828710367,1.019325745329663,1.0097194449468798,1.0047864469837062,1.0097194449468798,1.019325745329663,1.0498371644242794)
remove_na = !is.na(net_rate)
time = time[remove_na]
time=time-175
plot(time,time,type = 'n', ylim = c(-11.867571648920606, 1.7749085905820938), xlim = c(-123.348989-175,-24.45331-175), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-24.947788394999996, -25.936745185,-26.925701974999996,-27.914658765,-28.903615554999995,-29.892572344999998,-30.881529135,-31.870485924999997,-32.859442715,-33.848399504999996,-34.837356295,-35.826313084999995,-36.815269875,-37.804226665,-38.793183455,-39.782140244999994,-40.771097035,-41.760053825,-42.749010614999996,-43.73796740499999,-44.726924194999995,-45.715880985,-46.704837775,-47.693794565,-48.68275135499999,-49.671708145,-50.660664935,-51.649621725,-52.638578515,-53.627535304999995,-54.616492095,-55.605448885,-56.594405675000004,-57.58336246499999,-58.572319255,-59.561276045,-60.550232835,-61.53918962499999,-62.528146414999995,-63.517103205,-64.506059995,-65.495016785,-66.483973575,-67.472930365,-68.461887155,-69.450843945,-70.43980073499999,-71.428757525,-72.417714315,-73.406671105,-74.395627895,-75.384584685,-76.373541475,-77.362498265,-78.351455055,-79.340411845,-80.329368635,-81.318325425,-82.307282215,-83.296239005,-84.28519579499999,-85.274152585,-86.263109375,-87.252066165,-88.241022955,-89.22997974500001,-90.218936535,-91.207893325,-92.196850115,-93.185806905,-94.174763695,-95.163720485,-96.152677275,-97.141634065,-98.13059085500001,-99.119547645,-100.108504435,-101.097461225,-102.086418015,-103.075374805,-104.064331595,-105.053288385,-106.042245175,-107.03120196500001,-108.020158755,-109.009115545,-109.998072335,-110.987029125,-111.97598591500001,-112.964942705,-113.953899495,-114.942856285,-115.93181307500001,-116.920769865,-117.909726655,-118.898683445,-119.887640235,-120.87659702500001,-121.865553815,-122.854510605)
rate=c(0.14988040363064278, 2.468419999727145,2.4312337417499443,3.383632210375446,5.420102420024395,7.435565352917103,7.522239974416224,7.5390120832968,7.059905001149815,2.5384048669561086,4.338419819564981,11.081467842030875,14.918952872147829,15.014763432696371,15.340138103319324,17.132413136695828,18.374465423093714,18.796513515969586,19.083427319128525,19.309988313056035,19.41166744875892,19.5253592167155,19.5260049616807,19.487256246558303,19.476618515896067,19.434680247443723,18.785174159006083,13.816501303522793,8.701404296363684,9.52870271545059,10.232365006501272,10.378772564380604,10.422207938533324,10.424671534070876,10.42094078222919,10.078425549822319,7.987923358172608,5.187929810106308,2.589174586022299,3.6386528478727955,4.42444626351471,4.461213784729477,4.292942368241999,3.2975032096671515,3.378937666455977,3.544207151319018,5.01611603879627,5.266308850119561,3.5951314652760633,2.403474750041991,2.426255548313667,2.4262798298446056,2.0761496866157647,1.9309182303508692,2.3798802846017915,2.9703021275010064,3.7193415879921568,4.669208858571677,4.831853251343292,4.924194439301544,4.9930121075153355,5.185286424997364,6.026167827033345,6.3609046782947525,6.410315722527429,6.413736005715449,6.45953677972301,6.523518194337089,6.582241232214488,6.607016370299569,6.635389749473169,6.653068550466348,6.654787376473656,6.656164569408905,6.666168839987734,6.669428426963786,6.710227451722714,6.731670447858222,6.740521391741854,6.754563038131946,6.757008907864293,6.757008907864293,6.757008907864293,6.757008907864293,6.679207518505247,6.4001987087232095,6.755277603462853,6.9455624066060055,6.974090419477016,7.010673894311237,7.010673894311237,7.0101333611563925,6.989306497026928,6.936500162018146,6.776370229807684,6.711837563263179,6.6931693268715575,6.665822882284647,6.648479501189303,6.484737653613785)
minHPD=c(0.14988040363064278, 2.468419999727145,2.4312337417499443,3.383632210375446,5.420102420024395,7.435565352917103,7.522239974416224,7.5390120832968,7.059905001149815,2.5384048669561086,4.338419819564981,11.081467842030875,14.918952872147829,15.014763432696371,15.340138103319324,17.132413136695828,18.374465423093714,18.796513515969586,19.083427319128525,19.309988313056035,19.41166744875892,19.5253592167155,19.5260049616807,19.487256246558303,19.476618515896067,19.434680247443723,18.785174159006083,13.816501303522793,8.701404296363684,9.52870271545059,10.232365006501272,10.378772564380604,10.422207938533324,10.424671534070876,10.42094078222919,10.078425549822319,7.987923358172608,5.187929810106308,2.589174586022299,3.6386528478727955,4.42444626351471,4.461213784729477,4.292942368241999,3.2975032096671515,3.378937666455977,3.544207151319018,5.01611603879627,5.266308850119561,3.5951314652760633,2.403474750041991,2.426255548313667,2.4262798298446056,2.0761496866157647,1.9309182303508692,2.3798802846017915,2.9703021275010064,3.7193415879921568,4.669208858571677,4.831853251343292,4.924194439301544,4.9930121075153355,5.185286424997364,6.026167827033345,6.3609046782947525,6.410315722527429,6.413736005715449,6.45953677972301,6.523518194337089,6.582241232214488,6.607016370299569,6.635389749473169,6.653068550466348,6.654787376473656,6.656164569408905,6.666168839987734,6.669428426963786,6.710227451722714,6.731670447858222,6.740521391741854,6.754563038131946,6.757008907864293,6.757008907864293,6.757008907864293,6.757008907864293,6.679207518505247,6.4001987087232095,6.755277603462853,6.9455624066060055,6.974090419477016,7.010673894311237,7.010673894311237,7.0101333611563925,6.989306497026928,6.936500162018146,6.776370229807684,6.711837563263179,6.6931693268715575,6.665822882284647,6.648479501189303,6.484737653613785)
maxHPD=c(0.14988040363064278, 2.468419999727145,2.4312337417499443,3.383632210375446,5.420102420024395,7.435565352917103,7.522239974416224,7.5390120832968,7.059905001149815,2.5384048669561086,4.338419819564981,11.081467842030875,14.918952872147829,15.014763432696371,15.340138103319324,17.132413136695828,18.374465423093714,18.796513515969586,19.083427319128525,19.309988313056035,19.41166744875892,19.5253592167155,19.5260049616807,19.487256246558303,19.476618515896067,19.434680247443723,18.785174159006083,13.816501303522793,8.701404296363684,9.52870271545059,10.232365006501272,10.378772564380604,10.422207938533324,10.424671534070876,10.42094078222919,10.078425549822319,7.987923358172608,5.187929810106308,2.589174586022299,3.6386528478727955,4.42444626351471,4.461213784729477,4.292942368241999,3.2975032096671515,3.378937666455977,3.544207151319018,5.01611603879627,5.266308850119561,3.5951314652760633,2.403474750041991,2.426255548313667,2.4262798298446056,2.0761496866157647,1.9309182303508692,2.3798802846017915,2.9703021275010064,3.7193415879921568,4.669208858571677,4.831853251343292,4.924194439301544,4.9930121075153355,5.185286424997364,6.026167827033345,6.3609046782947525,6.410315722527429,6.413736005715449,6.45953677972301,6.523518194337089,6.582241232214488,6.607016370299569,6.635389749473169,6.653068550466348,6.654787376473656,6.656164569408905,6.666168839987734,6.669428426963786,6.710227451722714,6.731670447858222,6.740521391741854,6.754563038131946,6.757008907864293,6.757008907864293,6.757008907864293,6.757008907864293,6.679207518505247,6.4001987087232095,6.755277603462853,6.9455624066060055,6.974090419477016,7.010673894311237,7.010673894311237,7.0101333611563925,6.989306497026928,6.936500162018146,6.776370229807684,6.711837563263179,6.6931693268715575,6.665822882284647,6.648479501189303,6.484737653613785)
remove_na = !is.na(rate)
time = time[remove_na]
time=time-175
plot(time,time,type = 'n', ylim = c(0, 21.478605457848772), xlim = c(-123.348989-175,-24.45331-175), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()