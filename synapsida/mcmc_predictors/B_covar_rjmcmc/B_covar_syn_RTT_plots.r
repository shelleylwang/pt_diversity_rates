

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/synapsida/mcmc_predictors/B_covar/B_covar_syn_RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2), 
    oma=c(0,0,3,0),     # Increased top outer margin from 2 to 3
    mar=c(5,5,4,2)+0.1, # Increase plot margins for larger axis labels
    cex.lab=1.5,        # Increase axis label size
    cex.axis=1.2)       # Increase axis tick label size
library(scales)

time=c(-27.068001935, -28.141163805,-29.214325675,-30.287487545,-31.360649415,-32.433811285000004,-33.506973155,-34.580135025000004,-35.653296895,-36.726458765000004,-37.799620635,-38.872782505,-39.945944374999996,-41.019106245,-42.092268114999996,-43.165429985,-44.238591854999996,-45.311753725,-46.384915594999995,-47.458077465,-48.531239334999995,-49.604401205,-50.677563074999995,-51.750724945,-52.82388681500001,-53.897048685,-54.97021055500001,-56.043372425,-57.11653429500001,-58.189696165,-59.26285803500001,-60.336019905,-61.40918177500001,-62.482343645,-63.55550551500001,-64.628667385,-65.70182925499999,-66.774991125,-67.848152995,-68.921314865,-69.99447673499999,-71.067638605,-72.140800475,-73.213962345,-74.28712421499999,-75.360286085,-76.433447955,-77.50660982500001,-78.579771695,-79.652933565,-80.726095435,-81.79925730500001,-82.872419175,-83.945581045,-85.018742915,-86.09190478500001,-87.165066655,-88.238228525,-89.311390395,-90.38455226500001,-91.45771413499999,-92.530876005,-93.604037875,-94.67719974500001,-95.75036161500002,-96.823523485,-97.896685355,-98.96984722500001,-100.04300909500002,-101.116170965,-102.189332835,-103.26249470500001,-104.33565657500002,-105.408818445,-106.481980315,-107.55514218500001,-108.62830405500002,-109.701465925,-110.774627795,-111.84778966500001,-112.92095153500001,-113.994113405,-115.067275275,-116.140437145,-117.21359901500001,-118.28676088499999,-119.359922755,-120.433084625,-121.50624649500001,-122.57940836499999,-123.652570235,-124.725732105,-125.79889397500001,-126.87205584499999,-127.945217715,-129.01837958500002,-130.09154145500003,-131.16470332500003,-132.237865195,-133.31102706500002)
rate=c(0.12197343003695399, 0.12154615348035899,0.12100863934218622,0.12078875028353112,0.1207451426641504,0.12073337511692522,0.12023067201097942,0.11684402056210944,0.11269973799889077,0.1104877374672314,0.110144132265192,0.10970755889739267,0.10955530220045007,0.10952596609165424,0.10947882483961338,0.10943252265348799,0.10929068918592237,0.10943252265348799,0.10943252265348799,0.10943252265348799,0.10943252265348799,0.10947882483961338,0.10955530220045007,0.10955530220045007,0.10963916552368169,0.10963916552368169,0.10968049778728292,0.10968049778728292,0.10991137180836391,0.11071983476308918,0.11413015917818714,0.1186890303303946,0.1277962915618686,0.1349170601968093,0.13604179398134048,0.139917777744126,0.16439012496147298,0.21629644880437626,0.2354947403193049,0.2395326506064786,0.24504861349615695,0.24696379390458523,0.2922131186569009,0.2679601866201702,0.25448832202138444,0.2541085419927751,0.2541085419927751,0.2541085419927751,0.25245640439306993,0.2523849958803308,0.25229228975814977,0.2523849958803308,0.25393959088899776,0.27149062225908543,0.2817794444052515,0.27551147807128107,0.2744863887231296,0.2753361616230765,0.3098522887096541,0.3513055161107757,0.29619083005688773,0.2562928977584863,0.13755088268006582,0.13436568977643726,0.13414183436230848,0.13400634893632918,0.13387893874002632,0.13387893874002632,0.13367414159558294,0.1330837424471586,0.1330837424471586,0.13306047194630585,0.13306047194630585,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.13302792988370854,0.1330798626065126,0.1330798626065126,0.13323573552619405,0.13425838655677286,0.13544748329930956,0.13823478309682025,0.14575855112671454,0.2780706825551443,0.619951681538655,0.6953202603705448,0.7163578118994737,0.7242103644978006,0.7242103644978006)
minHPD=c(0.075602528641189, 0.0751822533099565,0.07033167382995621,0.0751822533099565,0.0751822533099565,0.0751822533099565,0.07622589823685971,0.050074125544164044,0.050074125544164044,0.052722361990561885,0.0525200554719315,0.052722361990561885,0.053340978818243415,0.053340978818243415,0.053340978818243415,0.053340978818243415,0.053359108337496304,0.0525200554719315,0.0525200554719315,0.0525200554719315,0.0525200554719315,0.053340978818243415,0.053340978818243415,0.053340978818243415,0.053340978818243415,0.053340978818243415,0.05281048882043875,0.05281048882043875,0.0525200554719315,0.053340978818243415,0.050074125544164044,0.06037905368823029,0.0819300415501725,0.08725525438909948,0.08725525438909948,0.09133941941213147,0.09054198210555227,0.09658283582802146,0.102769821859814,0.102769821859814,0.10188742403249845,0.10188742403249845,0.10482575757159532,0.13927062877320417,0.17006840501281725,0.17369507802601777,0.1745696099913396,0.1745696099913396,0.16969833083069777,0.16969833083069777,0.16969833083069777,0.16969833083069777,0.16969833083069777,0.19156600553912426,0.19499326389567156,0.15334549134386985,0.14626280233711386,0.15073404511184518,0.17786881110350503,0.1399993217017564,0.10719866329299445,0.07666203814459031,0.0783652890553229,0.0783652890553229,0.08766964547221733,0.08766964547221733,0.09068383211198279,0.09068383211198279,0.09321558462251853,0.09480703070324714,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09501682393621869,0.09480703070324714,0.09480703070324714,0.09501682393621869,0.09501682393621869,0.0928781015645706,0.08766964547221733,0.07666203814459031,0.07931796107233563,0.07666203814459031,0.08093456584927498,0.10576477218474309,0.10576477218474309,0.11475442593670084,0.2750956946809067,0.2640758807282162)
maxHPD=c(0.29174021810784334, 0.2851671409414155,0.26677696892440567,0.2649275057541869,0.2649275057541869,0.2649275057541869,0.26677696892440567,0.22737795824791143,0.157971841153782,0.14867660972574342,0.1463351038018324,0.14416486324902217,0.14416486324902217,0.14416486324902217,0.14416486324902217,0.144102914757969,0.144102914757969,0.14308864614600347,0.14308864614600347,0.14308864614600347,0.14308864614600347,0.144102914757969,0.14425678313897472,0.14430769398640272,0.14430769398640272,0.14430769398640272,0.14430769398640272,0.14430769398640272,0.1463351038018324,0.1525832538131198,0.22271228022683848,0.25579282075641385,0.2834997652939788,0.2866432682087968,0.2857556402219638,0.2915079558484967,0.3019080512825323,0.31933424046612985,0.32066561700675694,0.31867177651041906,0.320193877817911,0.32586500030493254,1.5743348823369554,1.0394955159627686,0.32586500030493254,0.32586500030493254,0.32586500030493254,0.32586500030493254,0.3225176841069828,0.3225176841069828,0.3225176841069828,0.3225176841069828,0.32590623173505073,0.3930281182065587,0.6224657112534723,0.4044761407883195,0.3930281182065587,0.41168340670190473,0.9438203222056334,1.0273582829856711,0.6346781068132665,0.4469990343174184,0.2830811745462836,0.18828192753609624,0.17512762836548626,0.17343831204018456,0.17441112213541946,0.17343831204018456,0.17441112213541946,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17325720650970142,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17343831204018456,0.17382803058372218,0.17441112213541946,0.17441112213541946,0.17444930525154367,0.17767661030024648,0.2931337088111401,0.41329721028209787,0.6809455427735709,0.90741973317616,1.163067885687223,1.2290604778449776,1.3273940307575927,1.4799365291537798,1.4562925345091597)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.731768370570651), xlim = c(-133.847608,-26.531421), ylab = 'Speciation rate', xlab = 'Time',main='Speciation' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mtext("Synapsida CoVar RJMCMC RTT Plots (Combined 10 Replicates)", outer = TRUE, line = 0.5, cex = 1.5, font = 2)
mids=c(-27.073421944444448, -28.157423833333333,-29.241425722222225,-30.32542761111111,-31.4094295,-32.49343138888889,-33.57743327777778,-34.66143516666667,-35.745437055555556,-36.82943894444444,-37.91344083333333,-38.997442722222225,-40.08144461111111,-41.1654465,-42.24944838888889,-43.33345027777778,-44.41745216666667,-45.501454055555556,-46.58545594444444,-47.66945783333333,-48.753459722222225,-49.83746161111112,-50.9214635,-52.00546538888889,-53.08946727777778,-54.17346916666667,-55.257471055555555,-56.34147294444445,-57.42547483333333,-58.509476722222225,-59.59347861111111,-60.6774805,-61.76148238888889,-62.84548427777778,-63.92948616666667,-65.01348805555556,-66.09748994444446,-67.18149183333334,-68.26549372222223,-69.34949561111112,-70.4334975,-71.51749938888891,-72.60150127777779,-73.68550316666668,-74.76950505555557,-75.85350694444445,-76.93750883333334,-78.02151072222223,-79.10551261111112,-80.18951450000002,-81.2735163888889,-82.35751827777779,-83.44152016666668,-84.52552205555556,-85.60952394444446,-86.69352583333334,-87.77752772222223,-88.86152961111112,-89.9455315,-91.02953338888891,-92.11353527777779,-93.19753716666666,-94.28153905555557,-95.36554094444445,-96.44954283333335,-97.53354472222223,-98.61754661111111,-99.70154850000002,-100.7855503888889,-101.8695522777778,-102.95355416666668,-104.03755605555556,-105.12155794444446,-106.20555983333334,-107.28956172222225,-108.37356361111112,-109.4575655,-110.54156738888891,-111.62556927777779,-112.70957116666666,-113.79357305555557,-114.87757494444445,-115.96157683333335,-117.04557872222223,-118.12958061111111,-119.21358250000002,-120.2975843888889,-121.3815862777778,-122.46558816666668,-123.54959005555556,-124.63359194444446,-125.71759383333334,-126.80159572222225,-127.88559761111112,-128.9695995,-130.0536013888889,-131.13760327777777,-132.22160516666668,-133.30560705555556)
counts=c(0.01, 0.014444444444444444,0.0077777777777777776,0.0033333333333333335,0.0033333333333333335,0.01,0.06333333333333334,0.08,0.03111111111111111,0.008888888888888889,0.005555555555555556,0.005555555555555556,0.0022222222222222222,0.0022222222222222222,0.0022222222222222222,0.0011111111111111111,0.0011111111111111111,0.0,0.0,0.0,0.0022222222222222222,0.0033333333333333335,0.0033333333333333335,0.0,0.0022222222222222222,0.0011111111111111111,0.0033333333333333335,0.005555555555555556,0.023333333333333334,0.08222222222222222,0.09222222222222222,0.14666666666666667,0.052222222222222225,0.012222222222222223,0.05444444444444444,0.08444444444444445,0.08,0.05555555555555555,0.022222222222222223,0.03111111111111111,0.01888888888888889,0.35777777777777775,0.3477777777777778,0.04111111111111111,0.005555555555555556,0.0011111111111111111,0.015555555555555555,0.011111111111111112,0.0,0.0044444444444444444,0.0077777777777777776,0.07444444444444444,0.19,0.03777777777777778,0.05,0.024444444444444446,0.06555555555555556,0.3888888888888889,0.24888888888888888,0.09444444444444444,0.4577777777777778,0.15555555555555556,0.028888888888888888,0.006666666666666667,0.0044444444444444444,0.0033333333333333335,0.006666666666666667,0.0077777777777777776,0.0022222222222222222,0.0033333333333333335,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0,0.0,0.0,0.0011111111111111111,0.0011111111111111111,0.0011111111111111111,0.0011111111111111111,0.0,0.0011111111111111111,0.0011111111111111111,0.0022222222222222222,0.0,0.006666666666666667,0.02,0.043333333333333335,0.05,0.1411111111111111,0.25,0.3277777777777778,0.12333333333333334,0.04555555555555556,0.024444444444444446,0.006666666666666667,0.005555555555555556)
plot(mids,counts,type = 'h', xlim = c(-133.847608,-26.531421), ylim=c(0,0.4577777777777778), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.034508250409250284
bf6 = 0.2089214177133588
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-27.068001935, -28.141163805,-29.214325675,-30.287487545,-31.360649415,-32.433811285000004,-33.506973155,-34.580135025000004,-35.653296895,-36.726458765000004,-37.799620635,-38.872782505,-39.945944374999996,-41.019106245,-42.092268114999996,-43.165429985,-44.238591854999996,-45.311753725,-46.384915594999995,-47.458077465,-48.531239334999995,-49.604401205,-50.677563074999995,-51.750724945,-52.82388681500001,-53.897048685,-54.97021055500001,-56.043372425,-57.11653429500001,-58.189696165,-59.26285803500001,-60.336019905,-61.40918177500001,-62.482343645,-63.55550551500001,-64.628667385,-65.70182925499999,-66.774991125,-67.848152995,-68.921314865,-69.99447673499999,-71.067638605,-72.140800475,-73.213962345,-74.28712421499999,-75.360286085,-76.433447955,-77.50660982500001,-78.579771695,-79.652933565,-80.726095435,-81.79925730500001,-82.872419175,-83.945581045,-85.018742915,-86.09190478500001,-87.165066655,-88.238228525,-89.311390395,-90.38455226500001,-91.45771413499999,-92.530876005,-93.604037875,-94.67719974500001,-95.75036161500002,-96.823523485,-97.896685355,-98.96984722500001,-100.04300909500002,-101.116170965,-102.189332835,-103.26249470500001,-104.33565657500002,-105.408818445,-106.481980315,-107.55514218500001,-108.62830405500002,-109.701465925,-110.774627795,-111.84778966500001,-112.92095153500001,-113.994113405,-115.067275275,-116.140437145,-117.21359901500001,-118.28676088499999,-119.359922755,-120.433084625,-121.50624649500001,-122.57940836499999,-123.652570235,-124.725732105,-125.79889397500001,-126.87205584499999,-127.945217715,-129.01837958500002,-130.09154145500003,-131.16470332500003,-132.237865195,-133.31102706500002)
rate=c(1.2528789955578812, 0.14646678728507917,0.13146517306017957,0.12622529097096957,0.1242296379319777,0.1237826438594683,0.12371832381359475,0.12278304510684898,0.12129457562104423,0.12022184367862973,0.11966042941075189,0.1194550116718922,0.11937478340548469,0.11937478340548469,0.11937478340548469,0.11937478340548469,0.11937478340548469,0.11942696665917799,0.11942696665917799,0.11942696665917799,0.11942696665917799,0.1195226811305336,0.11959948623359243,0.11966042941075189,0.11977279923370923,0.11973918299362109,0.11959948623359243,0.11959000694899277,0.11959000694899277,0.11959948623359243,0.11959948623359243,0.11966042941075189,0.12064169868950114,0.12284133454945916,0.12604251091679639,0.1279597616091796,0.1313474791937859,0.21051882038705183,0.3428656791996668,0.30803623582667794,0.30504348169107454,0.3047346685165786,0.32954768049895167,0.35807124006035135,0.35651431375065656,0.35958978938471164,0.386215854589543,0.5092176086824204,0.4453340854761766,0.4501102594287689,0.35489916374532043,0.3222335479475653,0.31110036508482913,0.3116787358010058,0.32266490913320134,0.27682692676300225,0.1533380874529522,0.14727286109287543,0.14514430256513022,0.14253438578691696,0.1332252596273557,0.12561212306482272,0.12062039017676138,0.11840216790686808,0.11776172139969962,0.1172014039171359,0.11677695284123607,0.11675793579061117,0.11667954985260703,0.11660121951595635,0.11660121951595635,0.11660121951595635,0.11660121951595635,0.11656109851639879,0.11656109851639879,0.11667954985260703,0.11675237286866799,0.11683751541158313,0.11756843564932891,0.11765789740746804,0.11765789740746804,0.11765789740746804,0.11765789740746804,0.11765789740746804,0.11765789740746804,0.11774124082202268,0.11778476729103012,0.11781556895726975,0.11788705319532647,0.1182328735147721,0.11851201633966407,0.11979759686997238,0.12215167216060993,0.12417854454945257,0.12696829834072176,0.13402336463992948,0.14039716936298255,0.1408358325859013,0.14253438578691696,0.14447725578646672)
minHPD=c(0.10187811656007006, 0.081483451300088,0.081483451300088,0.08847500800956669,0.08801529953806492,0.08489351323521153,0.08801529953806492,0.08801529953806492,0.081483451300088,0.08753091146268105,0.08828387581048179,0.08828387581048179,0.08847500800956669,0.08847500800956669,0.08847500800956669,0.08847500800956669,0.08847500800956669,0.08863804620610162,0.08863804620610162,0.08753091146268105,0.08753091146268105,0.08863804620610162,0.08847500800956669,0.08828387581048179,0.08828387581048179,0.08828387581048179,0.08801529953806492,0.08828387581048179,0.08801529953806492,0.08828387581048179,0.08828387581048179,0.08753091146268105,0.08458026999479036,0.07913715830289628,0.08753091146268105,0.08753091146268105,0.08378449304556632,0.08891151488492041,0.1169309927508425,0.09342910486637387,0.09342910486637387,0.09342910486637387,0.09488315609023158,0.18570831141135774,0.19456191544327409,0.18964699181556297,0.20155350637868705,0.27266376758169564,0.2813256025856453,0.2683190054590375,0.21113305438071686,0.20838720069964528,0.20785417160123318,0.20838720069964528,0.2015647954081809,0.11222093522277261,0.09801232772599812,0.0979493885159227,0.0979493885159227,0.09743677892199852,0.08938852299744203,0.07681103294121817,0.056550372406781166,0.06588491338653683,0.06577482624019704,0.07040430830980855,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.06519117059427464,0.07040430830980855,0.07009178558893622,0.07040430830980855,0.0685317427369894,0.06661464049545153,0.06018594041916015,0.061688473269602605,0.061688473269602605,0.062206404992485205,0.07339779438482599,0.07040430830980855,0.07477464013841224,0.07040430830980855,0.08145261540454155)
maxHPD=c(3.4814464601079025, 1.211652672425394,0.5564803846783271,0.3638913778024606,0.2891989929498871,0.27146015042915805,0.2655717089946787,0.2514687845418404,0.17203187629849243,0.15907434600054998,0.1565256506088755,0.15580817501146715,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.15422510538345766,0.15422510538345766,0.1558301945084169,0.1558301945084169,0.15580817501146715,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1558301945084169,0.1565256506088755,0.1565256506088755,0.1565256506088755,0.16483084808251872,0.2598449681686791,0.2986849143608337,0.3144230943536637,0.3235400112766274,0.4037631981723871,0.9067502397577455,0.4327148868709681,0.425502832588847,0.42718247276492116,0.5218023853040284,0.6004236021323952,0.6004236021323952,0.6004236021323952,0.7548435010433714,1.2251672660482518,0.7780613224021775,0.7782758241631409,0.6187963074333148,0.4485402496106108,0.42393334725732634,0.42393334725732634,0.4552724255376872,0.4327607328183465,0.28925678804133803,0.2785475663311084,0.27533183475492845,0.27426766921991186,0.2715309712902245,0.2568138967306767,0.20503828800810028,0.15588898535319806,0.15290332278596735,0.1554378666602568,0.1493169465968568,0.1493169465968568,0.1488360089734191,0.1488360089734191,0.1488360089734191,0.1488360089734191,0.1488360089734191,0.1488360089734191,0.1488360089734191,0.1488360089734191,0.14914016511986805,0.1493169465968568,0.15002576467450768,0.15002576467450768,0.15002576467450768,0.15002576467450768,0.15002576467450768,0.15002576467450768,0.15002576467450768,0.15002576467450768,0.1554614738541061,0.1554614738541061,0.15588898535319806,0.15578901576367735,0.15578901576367735,0.1778265242301363,0.28941086170329755,0.32582894542816804,0.4291138350687424,0.5841735098014148,0.7002484038661847,0.7180606405540836,0.7276979193028172,0.7637438776953976)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.829591106118693), xlim = c(-133.847608,-26.531421), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-27.073421944444448, -28.157423833333333,-29.241425722222225,-30.32542761111111,-31.4094295,-32.49343138888889,-33.57743327777778,-34.66143516666667,-35.745437055555556,-36.82943894444444,-37.91344083333333,-38.997442722222225,-40.08144461111111,-41.1654465,-42.24944838888889,-43.33345027777778,-44.41745216666667,-45.501454055555556,-46.58545594444444,-47.66945783333333,-48.753459722222225,-49.83746161111112,-50.9214635,-52.00546538888889,-53.08946727777778,-54.17346916666667,-55.257471055555555,-56.34147294444445,-57.42547483333333,-58.509476722222225,-59.59347861111111,-60.6774805,-61.76148238888889,-62.84548427777778,-63.92948616666667,-65.01348805555556,-66.09748994444446,-67.18149183333334,-68.26549372222223,-69.34949561111112,-70.4334975,-71.51749938888891,-72.60150127777779,-73.68550316666668,-74.76950505555557,-75.85350694444445,-76.93750883333334,-78.02151072222223,-79.10551261111112,-80.18951450000002,-81.2735163888889,-82.35751827777779,-83.44152016666668,-84.52552205555556,-85.60952394444446,-86.69352583333334,-87.77752772222223,-88.86152961111112,-89.9455315,-91.02953338888891,-92.11353527777779,-93.19753716666666,-94.28153905555557,-95.36554094444445,-96.44954283333335,-97.53354472222223,-98.61754661111111,-99.70154850000002,-100.7855503888889,-101.8695522777778,-102.95355416666668,-104.03755605555556,-105.12155794444446,-106.20555983333334,-107.28956172222225,-108.37356361111112,-109.4575655,-110.54156738888891,-111.62556927777779,-112.70957116666666,-113.79357305555557,-114.87757494444445,-115.96157683333335,-117.04557872222223,-118.12958061111111,-119.21358250000002,-120.2975843888889,-121.3815862777778,-122.46558816666668,-123.54959005555556,-124.63359194444446,-125.71759383333334,-126.80159572222225,-127.88559761111112,-128.9695995,-130.0536013888889,-131.13760327777777,-132.22160516666668,-133.30560705555556)
counts=c(0.6266666666666667, 0.19111111111111112,0.08555555555555555,0.05,0.011111111111111112,0.008888888888888889,0.017777777777777778,0.03888888888888889,0.027777777777777776,0.011111111111111112,0.0044444444444444444,0.0011111111111111111,0.0,0.0,0.0,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0,0.0033333333333333335,0.0022222222222222222,0.0011111111111111111,0.0022222222222222222,0.0022222222222222222,0.0022222222222222222,0.0011111111111111111,0.0022222222222222222,0.0022222222222222222,0.0,0.01,0.02666666666666667,0.07333333333333333,0.058888888888888886,0.04666666666666667,0.10111111111111111,0.49,0.20222222222222222,0.06888888888888889,0.0044444444444444444,0.011111111111111112,0.19444444444444445,0.035555555555555556,0.015555555555555555,0.03777777777777778,0.3,0.11,0.03666666666666667,0.09222222222222222,0.33,0.09444444444444444,0.021111111111111112,0.016666666666666666,0.04888888888888889,0.42333333333333334,0.16777777777777778,0.01888888888888889,0.012222222222222223,0.05555555555555555,0.1511111111111111,0.13333333333333333,0.06555555555555556,0.021111111111111112,0.011111111111111112,0.006666666666666667,0.0022222222222222222,0.0022222222222222222,0.0022222222222222222,0.0022222222222222222,0.0,0.0,0.0011111111111111111,0.0,0.0011111111111111111,0.0011111111111111111,0.005555555555555556,0.0077777777777777776,0.0011111111111111111,0.0,0.0,0.0,0.0,0.0,0.0,0.0033333333333333335,0.0022222222222222222,0.0022222222222222222,0.005555555555555556,0.01,0.027777777777777776,0.06222222222222222,0.04,0.06111111111111111,0.12,0.07222222222222222,0.015555555555555555,0.012222222222222223,0.011111111111111112,0.0011111111111111111)
plot(mids,counts,type = 'h', xlim = c(-133.847608,-26.531421), ylim=c(0,0.6266666666666667), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-27.068001935, -28.141163805,-29.214325675,-30.287487545,-31.360649415,-32.433811285000004,-33.506973155,-34.580135025000004,-35.653296895,-36.726458765000004,-37.799620635,-38.872782505,-39.945944374999996,-41.019106245,-42.092268114999996,-43.165429985,-44.238591854999996,-45.311753725,-46.384915594999995,-47.458077465,-48.531239334999995,-49.604401205,-50.677563074999995,-51.750724945,-52.82388681500001,-53.897048685,-54.97021055500001,-56.043372425,-57.11653429500001,-58.189696165,-59.26285803500001,-60.336019905,-61.40918177500001,-62.482343645,-63.55550551500001,-64.628667385,-65.70182925499999,-66.774991125,-67.848152995,-68.921314865,-69.99447673499999,-71.067638605,-72.140800475,-73.213962345,-74.28712421499999,-75.360286085,-76.433447955,-77.50660982500001,-78.579771695,-79.652933565,-80.726095435,-81.79925730500001,-82.872419175,-83.945581045,-85.018742915,-86.09190478500001,-87.165066655,-88.238228525,-89.311390395,-90.38455226500001,-91.45771413499999,-92.530876005,-93.604037875,-94.67719974500001,-95.75036161500002,-96.823523485,-97.896685355,-98.96984722500001,-100.04300909500002,-101.116170965,-102.189332835,-103.26249470500001,-104.33565657500002,-105.408818445,-106.481980315,-107.55514218500001,-108.62830405500002,-109.701465925,-110.774627795,-111.84778966500001,-112.92095153500001,-113.994113405,-115.067275275,-116.140437145,-117.21359901500001,-118.28676088499999,-119.359922755,-120.433084625,-121.50624649500001,-122.57940836499999,-123.652570235,-124.725732105,-125.79889397500001,-126.87205584499999,-127.945217715,-129.01837958500002,-130.09154145500003,-131.16470332500003,-132.237865195,-133.31102706500002)
net_rate=c(-1.37670053707034, -0.22886941327565144,-0.06157006242018915,-0.020100227303009126,-0.004219623393581218,-0.001676206459142187,-0.001166570260146276,-0.008232036770466506,-0.013777095072724328,-0.014354558454172823,-0.013560601229953237,-0.013496636661680845,-0.013752296845335056,-0.01380907553273626,-0.013891662120167781,-0.013933578396202457,-0.014024262736509276,-0.01401399382555185,-0.01401399382555185,-0.014052485336764434,-0.014052485336764434,-0.014202000813518599,-0.014210436468197803,-0.01414638513216428,-0.014163525811128848,-0.014121054263242946,-0.013894311949433457,-0.013779363200672351,-0.013117777851087366,-0.010828383787733997,-0.0015216016684607922,0.010427976315163855,0.028656687128281344,0.03493802543592384,0.024015972051803766,0.02243612323191911,0.025658316091429996,-0.024568513153074303,-0.16610526967895045,-0.07846072116219313,-0.06949368157862608,-0.06207442837591235,0.27193980991472505,-0.034329145279466934,-0.11302566445525258,-0.11954092093852606,-0.17447723114233868,-0.31893483861416483,-0.24120585349903184,-0.24548826414482972,-0.12242806817618203,-0.07128850071486781,-0.05988353445835825,-0.03330720909796811,-0.011663787850055176,-0.009632716246222337,0.09019229549476335,0.09856441040207847,0.22501046345811623,0.2919515848915162,0.16087767231231714,0.10502821207775377,0.027030055234141794,0.022263065831384585,0.02137735461434936,0.021861431949257618,0.02210745109877186,0.02175016278002847,0.021273079024824174,0.0205441287128474,0.02042854695150251,0.020330331525588812,0.020330331525588812,0.020322346304114686,0.020322346304114686,0.020241360098842143,0.01999613336062889,0.019661266931941427,0.019137093759249154,0.019117395191806108,0.019107034826652432,0.019055954978911434,0.019039390814615587,0.019045411293365653,0.019045411293365653,0.018963638264841643,0.01880455163913851,0.018833293546618054,0.01874716192170784,0.01878744431395607,0.021329051168945585,0.02696249839373907,0.029167002102098275,0.09595501775068337,0.21839586005659287,0.40186048743291286,0.46516995445163634,0.5015298843380712,0.5071632334340477,0.5007336181473337)
net_minHPD=c(-3.3859003662016502, -1.0202733050298225,-0.46055721302987623,-0.221358435621888,-0.11241252754407402,-0.10908326844463131,-0.10803854970621532,-0.10803854970621532,-0.09063903683969488,-0.07397864843924346,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06482226716587991,-0.06620840035747702,-0.07620856142576815,-0.07817864229911323,-0.06667439329522627,-0.05053584144068453,-0.06229906441378723,-0.10074793363406068,-0.13980349195054237,-0.16023043436623613,-0.23963022712833193,-0.7387579675770969,-0.2723726645576571,-0.2559465482585525,-0.2568774065987335,-0.3199376742120704,-0.4017230586934774,-0.3880187990260376,-0.38996858423749503,-0.46891307141875344,-0.9903123355755712,-0.537170031402229,-0.5521518944470369,-0.34840062336597954,-0.2179269823389705,-0.20783238817829036,-0.21749100746538153,-0.1999332030064117,-0.24456792894206386,-0.07847979419408757,-0.049569205140372635,-0.07609968666136335,-0.04750136903058333,-0.11009236766313221,-0.15516982835805446,-0.12710583310876428,-0.03254169063881422,-0.03204720493881956,-0.031096332617513225,-0.031096332617513225,-0.03254169063881422,-0.029473587207110588,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03254169063881422,-0.03254169063881422,-0.03254169063881422,-0.03254169063881422,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03204720493881956,-0.03254169063881422,-0.029473587207110588,-0.03254169063881422,-0.03744691488815713,-0.0973518001909997,-0.22986135710486963,-0.24878776718564705,-0.2516322941444383,-0.16852794156522433,-0.20895215278827783,-0.2318512708644937,-0.3084080621897717,-0.18774918310736888)
net_maxHPD=c(0.005158169390215045, 0.23669201442773818,0.19022265525981952,0.19022265525981952,0.17553658766002794,0.1557459144346336,0.14793971125520927,0.14793971125520927,0.09749361052912923,0.040066932418707735,0.040066932418707735,0.03742683095589554,0.034486941536709656,0.03437646340229433,0.03437646340229433,0.03437646340229433,0.03347596153936691,0.03317098344739637,0.03317098344739637,0.03317098344739637,0.03317098344739637,0.03317098344739637,0.03306419138113158,0.03317098344739637,0.03341989929102912,0.03341989929102912,0.03434650155668255,0.03347596153936691,0.03477715769444885,0.03477715769444885,0.11346599412474706,0.14517182730710856,0.18383985670709346,0.19652058451592186,0.18383985670709346,0.18414996423038468,0.19593999837606263,0.18592685199567158,0.18034022148911186,0.08757312288317799,0.10588983133462448,0.12114050194609727,1.3668897379615332,0.7807030219281951,0.07910875409874352,0.07119057417207272,0.06737317227306272,0.012605994897285755,-0.02748654370452347,-0.02919123084349784,0.08730777217242636,0.08033163010569253,0.07772666168913259,0.10106931727765203,0.33467518339829566,0.2296060192719618,0.23861943488783688,0.25671423739291094,0.7361044855643089,0.9058649844972559,0.46844031845934975,0.3093163979453869,0.19317066384278797,0.15290373608399227,0.08264934653120902,0.07693987541893252,0.07197958415252091,0.06973808657293432,0.07064208441289935,0.06493838914981963,0.06459316796884719,0.06493838914981963,0.06493838914981963,0.06493838914981963,0.06493838914981963,0.06493838914981963,0.06630048018321091,0.06493838914981963,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06432360681173216,0.06493838914981963,0.06865937079179715,0.06973808657293432,0.08552297713618846,0.23923671740966146,0.32556404994991345,0.5946863231564895,0.88489746040861,1.0819559749268923,1.0974304844501024,1.1474969879965615,1.1474969879965615,1.3257315825378586)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-3.7244904028218158, 1.5035787117576866), xlim = c(-133.847608,-26.531421), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-27.068001935, -28.141163805,-29.214325675,-30.287487545,-31.360649415,-32.433811285000004,-33.506973155,-34.580135025000004,-35.653296895,-36.726458765000004,-37.799620635,-38.872782505,-39.945944374999996,-41.019106245,-42.092268114999996,-43.165429985,-44.238591854999996,-45.311753725,-46.384915594999995,-47.458077465,-48.531239334999995,-49.604401205,-50.677563074999995,-51.750724945,-52.82388681500001,-53.897048685,-54.97021055500001,-56.043372425,-57.11653429500001,-58.189696165,-59.26285803500001,-60.336019905,-61.40918177500001,-62.482343645,-63.55550551500001,-64.628667385,-65.70182925499999,-66.774991125,-67.848152995,-68.921314865,-69.99447673499999,-71.067638605,-72.140800475,-73.213962345,-74.28712421499999,-75.360286085,-76.433447955,-77.50660982500001,-78.579771695,-79.652933565,-80.726095435,-81.79925730500001,-82.872419175,-83.945581045,-85.018742915,-86.09190478500001,-87.165066655,-88.238228525,-89.311390395,-90.38455226500001,-91.45771413499999,-92.530876005,-93.604037875,-94.67719974500001,-95.75036161500002,-96.823523485,-97.896685355,-98.96984722500001,-100.04300909500002,-101.116170965,-102.189332835,-103.26249470500001,-104.33565657500002,-105.408818445,-106.481980315,-107.55514218500001,-108.62830405500002,-109.701465925,-110.774627795,-111.84778966500001,-112.92095153500001,-113.994113405,-115.067275275,-116.140437145,-117.21359901500001,-118.28676088499999,-119.359922755,-120.433084625,-121.50624649500001,-122.57940836499999,-123.652570235,-124.725732105,-125.79889397500001,-126.87205584499999,-127.945217715,-129.01837958500002,-130.09154145500003,-131.16470332500003,-132.237865195,-133.31102706500002)
rate=c(0.6549529841773821, 2.683178961707103,5.009200326645789,6.398060701287235,7.128355848798767,7.2652577418691076,7.302475703462931,7.463803842089222,7.880362873033553,8.141760072665766,8.269887495428163,8.307045587387112,8.313176723252091,8.313176723252091,8.313176723252091,8.313176723252091,8.313176723252091,8.3076380443215,8.3076380443215,8.304982330697616,8.304982330697616,8.288544630405333,8.277384200192014,8.27324238301025,8.264598079716938,8.266597102663711,8.2718466814539,8.279492483053373,8.284261860130549,8.271830051550932,8.271830051550932,8.248047997250438,8.042759926706601,7.412048101151177,6.855578249679663,6.582013903107197,6.160071592645214,4.4183409180131985,2.62648192934781,3.365762483894503,3.406200541835193,3.4174507279930886,3.09348916981513,2.6034157532654816,2.707847950671774,2.676622140846684,2.337208353214884,1.747374987653551,2.036282191266128,2.019920021868237,2.688612647310496,3.115109945285039,3.2076901289604143,3.2044563538088795,3.047174731355582,3.4256414273365685,5.410316136031437,5.577760930973365,5.651033565756274,5.724146463441895,6.2416983812191535,7.190786253803784,8.131311995062354,8.59573526909459,8.733213025813876,8.816425728915211,8.842897792796853,8.84487409348246,8.854010174262749,8.86725577720131,8.865473998969243,8.865473998969243,8.865473998969243,8.867903483246918,8.867903483246918,8.860414311687146,8.841204050685455,8.815105850618751,8.774561742089926,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.769776582728504,8.747172240331162,8.740088073126445,8.73351350173769,8.674574741849344,8.568108014855135,8.242999285123805,7.365009681344308,6.873809940319696,5.93674495935531,4.545168124471985,3.9243703523771987,3.8287799187845377,3.671931592181115,3.5590406342091336)
minHPD=c(0.6549529841773821, 2.683178961707103,5.009200326645789,6.398060701287235,7.128355848798767,7.2652577418691076,7.302475703462931,7.463803842089222,7.880362873033553,8.141760072665766,8.269887495428163,8.307045587387112,8.313176723252091,8.313176723252091,8.313176723252091,8.313176723252091,8.313176723252091,8.3076380443215,8.3076380443215,8.304982330697616,8.304982330697616,8.288544630405333,8.277384200192014,8.27324238301025,8.264598079716938,8.266597102663711,8.2718466814539,8.279492483053373,8.284261860130549,8.271830051550932,8.271830051550932,8.248047997250438,8.042759926706601,7.412048101151177,6.855578249679663,6.582013903107197,6.160071592645214,4.4183409180131985,2.62648192934781,3.365762483894503,3.406200541835193,3.4174507279930886,3.09348916981513,2.6034157532654816,2.707847950671774,2.676622140846684,2.337208353214884,1.747374987653551,2.036282191266128,2.019920021868237,2.688612647310496,3.115109945285039,3.2076901289604143,3.2044563538088795,3.047174731355582,3.4256414273365685,5.410316136031437,5.577760930973365,5.651033565756274,5.724146463441895,6.2416983812191535,7.190786253803784,8.131311995062354,8.59573526909459,8.733213025813876,8.816425728915211,8.842897792796853,8.84487409348246,8.854010174262749,8.86725577720131,8.865473998969243,8.865473998969243,8.865473998969243,8.867903483246918,8.867903483246918,8.860414311687146,8.841204050685455,8.815105850618751,8.774561742089926,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.769776582728504,8.747172240331162,8.740088073126445,8.73351350173769,8.674574741849344,8.568108014855135,8.242999285123805,7.365009681344308,6.873809940319696,5.93674495935531,4.545168124471985,3.9243703523771987,3.8287799187845377,3.671931592181115,3.5590406342091336)
maxHPD=c(0.6549529841773821, 2.683178961707103,5.009200326645789,6.398060701287235,7.128355848798767,7.2652577418691076,7.302475703462931,7.463803842089222,7.880362873033553,8.141760072665766,8.269887495428163,8.307045587387112,8.313176723252091,8.313176723252091,8.313176723252091,8.313176723252091,8.313176723252091,8.3076380443215,8.3076380443215,8.304982330697616,8.304982330697616,8.288544630405333,8.277384200192014,8.27324238301025,8.264598079716938,8.266597102663711,8.2718466814539,8.279492483053373,8.284261860130549,8.271830051550932,8.271830051550932,8.248047997250438,8.042759926706601,7.412048101151177,6.855578249679663,6.582013903107197,6.160071592645214,4.4183409180131985,2.62648192934781,3.365762483894503,3.406200541835193,3.4174507279930886,3.09348916981513,2.6034157532654816,2.707847950671774,2.676622140846684,2.337208353214884,1.747374987653551,2.036282191266128,2.019920021868237,2.688612647310496,3.115109945285039,3.2076901289604143,3.2044563538088795,3.047174731355582,3.4256414273365685,5.410316136031437,5.577760930973365,5.651033565756274,5.724146463441895,6.2416983812191535,7.190786253803784,8.131311995062354,8.59573526909459,8.733213025813876,8.816425728915211,8.842897792796853,8.84487409348246,8.854010174262749,8.86725577720131,8.865473998969243,8.865473998969243,8.865473998969243,8.867903483246918,8.867903483246918,8.860414311687146,8.841204050685455,8.815105850618751,8.774561742089926,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.77304535369362,8.769776582728504,8.747172240331162,8.740088073126445,8.73351350173769,8.674574741849344,8.568108014855135,8.242999285123805,7.365009681344308,6.873809940319696,5.93674495935531,4.545168124471985,3.9243703523771987,3.8287799187845377,3.671931592181115,3.5590406342091336)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 9.754693831571611), xlim = c(-133.847608,-26.531421), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()